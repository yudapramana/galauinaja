import{_ as P,u as U,r as I,e as g,f as B,g as C,c as d,o as u,h as f,a as e,w as A,T as M,i as N,j as w,v as q,k as R,n as j,l as E,m as G,d as z,p as K,q as O,s as T,t as W,x as F}from"./app-CPYwAf2T.js";import{u as X}from"./MasterDataStore-COSrodwT.js";import{R as $}from"./laravel-turnstile-vue.es-D4u7gKNP.js";import"./LoadingStore-COFrh0uM.js";const H={class:"login-page"},J={key:0,class:"loading-overlay"},Q={class:"login-box"},Y={class:"card card-outline card-success"},Z={class:"card-body login-card-body"},ee={key:0,class:"alert alert-danger",role:"alert"},se={class:"input-group mb-3"},te={class:"input-group mb-3"},ae=["type"],oe={class:"input-group-append"},ne={class:"text-center row justify-content-center"},re={class:"form-group recaptcha-container mx-auto"},ie={class:"row mb-3"},le={class:"col-8"},de={class:"icheck-primary"},ue={class:"col-4"},pe=["disabled"],ce={key:0},me={key:1},ve="0x4AAAAAABg5q-5b8cUPKPGt",ge={__name:"Login",setup(fe){const p=U(),V=X(),D=O(),a=I({username:"",password:"",remember:!0}),c=g(!1),i=g(!1),l=g(""),o=g(""),b=async()=>{o.value="",await K();try{window!=null&&window.turnstile&&window.turnstile.reset()}catch{}},h=n=>{n.persisted&&b()};B(()=>{window.addEventListener("pageshow",h)}),C(()=>{window.removeEventListener("pageshow",h)});const L=async()=>{var n,s,t,y,_,x,k,S;if(!o.value){l.value="Mohon selesaikan verifikasi captcha.";return}i.value=!0,l.value="";try{await F.post("/login",{...a,"cf-turnstile-response":o.value}),await p.getAuthUser(),await V.getDoctypeList(),await p.getMyDocuments(),p.isAuthenticated=!0,p.activeLayout="user",D.push("/user/dashboard")}catch(m){console.error("Login error:",m);let v=((s=(n=m.response)==null?void 0:n.data)==null?void 0:s.message)||"Terjadi kesalahan saat login.";if(((t=m.response)==null?void 0:t.status)===422){const r=((_=(y=m.response)==null?void 0:y.data)==null?void 0:_.errors)||{};(x=r["cf-turnstile-response"])!=null&&x.length?v=r["cf-turnstile-response"][0]:(k=r.username)!=null&&k.length?v=r.username[0]:(S=r.password)!=null&&S.length&&(v=r.password[0])}l.value=v}finally{await b(),setTimeout(()=>{i.value=!1},400)}};return(n,s)=>(u(),d("div",H,[f(M,{name:"fade"},{default:A(()=>[i.value?(u(),d("div",J,s[5]||(s[5]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memproses login...",-1)]))):T("",!0)]),_:1}),e("div",Q,[s[11]||(s[11]=e("div",{class:"login-logo"},[e("img",{src:"http://res.cloudinary.com/dezj1x6xp/image/upload/v1749880420/PandanViewMandeh/LOGO_SIGARDA_FIX_rw2u1g.png",alt:"logo Ekin",width:"100%"})],-1)),e("div",Y,[e("div",Z,[s[8]||(s[8]=e("p",{class:"login-box-msg"},"Silakan masuk untuk memulai sesi",-1)),f(M,{name:"fade"},{default:A(()=>[l.value?(u(),d("div",ee,W(l.value),1)):T("",!0)]),_:1}),e("form",{onSubmit:N(L,["prevent"]),autocomplete:"off"},[e("div",se,[w(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>a.username=t),type:"text",class:"form-control",placeholder:"NIP Anda",required:"",autocomplete:"username"},null,512),[[q,a.username]]),s[6]||(s[6]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-envelope"})])],-1))]),e("div",te,[w(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.password=t),type:c.value?"text":"password",class:"form-control",placeholder:"Password",required:"",autocomplete:"current-password"},null,8,ae),[[R,a.password]]),e("div",oe,[e("button",{class:"input-group-text",type:"button",onClick:s[2]||(s[2]=t=>c.value=!c.value),tabindex:"-1"},[e("i",{class:j(c.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",ne,[e("div",re,[f(E($),{modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=t=>o.value=t),sitekey:ve,theme:"light"},null,8,["modelValue"])])]),e("div",ie,[e("div",le,[e("div",de,[w(e("input",{type:"checkbox",id:"remember","onUpdate:modelValue":s[4]||(s[4]=t=>a.remember=t)},null,512),[[G,a.remember]]),s[7]||(s[7]=e("label",{for:"remember"},"Â  Remember Me",-1))])]),e("div",ue,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:i.value||!o.value},[i.value?(u(),d("span",ce,"Memuat...")):(u(),d("span",me,"Sign In"))],8,pe)])])],32),s[9]||(s[9]=e("p",{class:"mb-0"},[z(" Lupa Password? "),e("a",{href:"/password/wa/request",target:"_blank"},"Reset Disini")],-1)),s[10]||(s[10]=e("a",{class:"text-sm text-muted",href:"https://wa.me/6282298476941?text=Assalamualaikum Wr Wb Admin Sigarda,%2C%20Saya%20Ingin%20Bertanya%20Tentang%20Sigarda,%20NIP%20Saya%20adalah:",target:"_blank"},"Tanya admin?",-1))])])])]))}},_e=P(ge,[["__scopeId","data-v-31bdbcd0"]]);export{_e as default};
