import{q as R,h as v,s as N,u as $,f as j,J as A,K as p,y as F,c as t,a as e,A as a,m as r,k as f,E as k,L as K,F as c,C as u,j as z,N as T,n as H,o as s,t as l,b as x}from"./app-BWyiWbCj.js";import{f as D,a as E}from"./helper-BuG6Si5x.js";import{a as O}from"./laravel-vue-pagination.es-BLTnNx7Q.js";import"./sweetalert2.all-CGkhAqbs.js";const W={class:"content-header"},q={class:"container-fluid"},J={class:"row mb-2"},G=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"LCHK Satker")],-1),Q={key:0,class:"col-sm-6"},X=e("ol",{class:"breadcrumb float-sm-right"},[e("li",{class:"breadcrumb-item"},[e("a",{href:"#"},"Home")]),e("li",{class:"breadcrumb-item active"},"LCKH Satker")],-1),Z=[X],ee={class:"content"},se={class:"container-fluid"},te={class:"row"},oe={class:"col-12"},ae={class:"card"},le={class:"card-body"},ie={class:"row"},ne={class:"col-6"},de={class:"form-group"},ce=e("label",{for:"mont",style:{"font-size":"small"}},"Bulan",-1),re=["value"],_e={key:0,class:"col-6"},ue={class:"form-group"},he=e("label",{for:"organization_id",style:{"font-size":"small"}},"Satuan Kerja",-1),me=["placeholder"],ve=["value"],pe={key:1,class:"col-6"},ge={class:"form-group"},ye=e("label",{for:"organization_id",style:{"font-size":"small"}},"Satuan Kerja",-1),be=["value"],fe={key:2,class:"col-12"},ke={class:"form-group"},xe=e("label",{for:"user_id",style:{"font-size":"small"}},"Pilih Pegawai",-1),Me=["placeholder"],Se=["value"],Ye={key:3,class:"col-12"},De={class:"form-group"},we=e("label",{for:"user_id",style:{"font-size":"small"}},"Pilih Pegawai",-1),Ie=["placeholder"],Le=["value"],Pe={class:"col-6"},ze=["disabled"],Ee={key:0,class:"spinner-border spinner-border-sm mr-2",role:"status"},Ue=e("span",{class:"sr-only"},"Loading...",-1),Ve=[Ue],Be={key:1},Ce={class:"col-6"},Re=["disabled"],Ne={key:0,class:"spinner-border spinner-border-sm mr-2",role:"status"},$e=e("span",{class:"sr-only"},"Loading...",-1),je=[$e],Ae={key:1},Fe={key:0,class:"timeline"},Ke=e("hr",null,null,-1),Te={key:0,class:"time-label"},He={class:"bg-primary badge badge-primary badge-sm"},Oe={class:"timeline-item"},We={class:"time"},qe={class:"timeline-header",style:{"font-size":"smaller","line-height":"1 !important"}},Je={class:"time"},Ge={class:"timeline-body",style:{"font-size":"small","line-height":"1 !important"}},Qe=e("br",null,null,-1),Xe={style:{"font-size":"smaller"}},Ze=e("br",null,null,-1),es={style:{"text-align":"right"}},ss={style:{"font-size":"smaller",width:"100%"}},ts=["href"],os={class:"bg-primary badge badge-primary badge-sm"},as={key:1,class:"text-center"},ls={key:1,class:"card"},is={class:"card-body"},ns={class:"table-responsive overlay-wrapper",id:"example-table"},ds={key:0,class:"overlay"},cs=e("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1),rs=e("div",{class:"text-bold pt-2"},"Loading...",-1),_s=[cs,rs],us={class:"table table-bordered"},hs=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Tanggal"),e("th",{scope:"col",class:"text-center"},"#"),e("th",{scope:"col",width:"50%"},"Pekerjaan"),e("th",{scope:"col",class:"text-right"},"Volume"),e("th",{scope:"col"},"Eviden")])],-1),ms={key:0},vs=["rowspan"],ps={class:"text-center"},gs={class:"s"},ys=e("br",null,null,-1),bs={class:"text-muted m-0 p-0",style:{"font-size":"small !important"}},fs={class:"s text-center"},ks={class:"s"},xs={class:"s"},Ms=e("td",{class:"s text-center"},null,-1),Ss=e("td",{colspan:"7",class:"text-center"},"Belum ada data...",-1),Ys={key:1},Ds=e("tr",null,[e("td",{colspan:"7",class:"text-center"},"Tidak ada hasil, silahkan pilih bulan... ")],-1),ws=[Ds],Is={key:3},Ls=["src"],Bs={__name:"Orgreports",setup(Ps){const M=R(),g=v(!1),S=v(!1),_=v(!1),Y=v("Pilih Item"),U=N(),h=$(),n=j(),m=v({data:[]}),y=A("SettingStore:mySelected",v("")),V=v([{text:p().subtract(2,"months").format("MMMM  YYYY"),id:p().subtract(2,"months").format("YYYY-MM")},{text:p().subtract(1,"months").format("MMMM  YYYY"),id:p().subtract(1,"months").format("YYYY-MM")},{text:p().format("MMMM  YYYY"),id:p().format("YYYY-MM")}]),w=(I=1)=>{_.value=!0,H.get(`/api/reports?monthyear=${y.value}&page=${I}&user_id=${n.userId}`).then(i=>{console.log(i.data),m.value=i.data,_.value=!1,g.value=!0,S.value=!1,_.value=!1}).catch(i=>{console.log(i.response.data),i.response&&i.response.status===401?window.location.href="/login":console.error("Terjadi kesalahan:",i)})},B=()=>{_.value=!0,g.value=!1,S.value=!0,setTimeout(function(){_.value=!1},2e3)};return F(()=>{n.getOrgList(),h.user.role=="ADMIN"&&n.getUserListbyOrgID(h.user.org_id)}),(I,i)=>{var L,P;return s(),t(c,null,[e("div",W,[e("div",q,[e("div",J,[G,a(M).isMobile?r("",!0):(s(),t("div",Q,Z))])])]),e("div",ee,[e("div",se,[e("div",te,[e("div",oe,[e("div",ae,[e("div",le,[e("div",ie,[e("div",ne,[e("div",de,[ce,f(e("select",{"onUpdate:modelValue":i[0]||(i[0]=o=>K(y)?y.value=o:null),class:"custom-select rounded-0"},[(s(!0),t(c,null,u(V.value,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,re))),128))],512),[[k,a(y)]])])]),a(h).user.role=="SUPERADMIN"||a(h).user.role=="REVIEWER"?(s(),t("div",_e,[e("div",ue,[he,f(e("select",{"onUpdate:modelValue":i[1]||(i[1]=o=>a(n).orgId=o),class:"custom-select rounded-0",placeholder:Y.value,onChange:i[2]||(i[2]=o=>a(n).getUserList(a(n).orgId)),onSelect:i[3]||(i[3]=o=>a(n).getUserList(a(n).orgId))},[(s(!0),t(c,null,u(a(n).orgList,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,ve))),128))],40,me),[[k,a(n).orgId]])])])):(s(),t("div",pe,[e("div",ge,[ye,e("input",{type:"text",class:"form-control",disabled:"",value:a(h).user.org_name},null,8,be)])])),a(h).user.role=="SUPERADMIN"||a(h).user.role=="REVIEWER"?(s(),t("div",fe,[e("div",ke,[xe,f(e("select",{"onUpdate:modelValue":i[4]||(i[4]=o=>a(n).userId=o),class:"custom-select rounded-0",placeholder:Y.value},[(s(!0),t(c,null,u(a(n).userList,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,Se))),128))],8,Me),[[k,a(n).userId]])])])):(s(),t("div",Ye,[e("div",De,[we,f(e("select",{"onUpdate:modelValue":i[5]||(i[5]=o=>a(n).userId=o),class:"custom-select rounded-0",placeholder:Y.value},[(s(!0),t(c,null,u(a(n).userList,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,Le))),128))],8,Ie),[[k,a(n).userId]])])])),e("div",Pe,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:_.value,onClick:z(w,["prevent"])},[_.value?(s(),t("div",Ee,Ve)):(s(),t("span",Be,"Preview Data"))],8,ze)]),e("div",Ce,[e("button",{type:"submit",class:"btn btn-warning btn-block",disabled:_.value,onClick:z(B,["prevent"])},[_.value?(s(),t("div",Ne,je)):(s(),t("span",Ae,"Preview PDF"))],8,Re)])])])]),g.value&&a(M).isMobile?(s(),t("div",Fe,[Ke,m.value.data.length>0?(s(!0),t(c,{key:0},u(m.value.data,(o,C)=>(s(),t(c,null,[o.works.length>0?(s(!0),t(c,{key:0},u(o.works,(d,b)=>(s(),t(c,{key:d.id},[b===0?(s(),t("div",Te,[e("span",He,l(a(D)(o.date)),1)])):r("",!0),e("div",null,[e("div",Oe,[e("span",We," ["+l(d.volume)+" "+l(d.unit)+"] ",1),e("h3",qe,[e("span",Je,l(a(D)(o.date)),1)]),e("div",Ge,[x(l(d.work_name),1),Qe,e("span",Xe,l(d.work_detail),1),Ze,e("div",es,[e("span",ss,[x(" Bukti Dukung "),d.evidence_url?(s(),t("a",{key:0,target:"blank",href:d.evidence_url??"#"}," [ "+l(d.evidence)+" ]",9,ts)):(s(),t(c,{key:1},[x(" [ "+l(d.evidence)+" ] ",1)],64))])])])])])],64))),128)):(s(),t(c,{key:1},[(s(),t("div",{class:"time-label",key:o.id},[e("span",os,l(a(D)(o.date)),1)])),(s(),t("div",{key:o.id,class:"text-center"}," .: Belum ada Data :. "))],64))],64))),256)):(s(),t("div",as," .: Belum ada data :. "))])):r("",!0),g.value&&!a(M).isMobile?(s(),t("div",ls,[e("div",is,[e("div",ns,[a(U).isLoading?(s(),t("div",ds,_s)):r("",!0),e("table",us,[hs,((L=m.value.data)==null?void 0:L.length)>0?(s(),t("tbody",ms,[(s(!0),t(c,null,u(m.value.data,(o,C)=>(s(),t(c,null,[o.works.length>0?(s(!0),t(c,{key:0},u(o.works,(d,b)=>(s(),t("tr",{key:d.id},[b===0?(s(),t("td",{key:0,rowspan:o.works.length,class:"s",style:{"white-space":"pre"}},l(a(E)(o.date)),9,vs)):r("",!0),e("td",ps,l(b+1),1),e("td",gs,[x(l(d.work_name)+" ",1),ys,e("p",bs,l(d.work_detail),1)]),e("td",fs,l(d.volume)+"Â "+l(d.unit),1),e("td",ks,l(d.evidence),1)]))),128)):(s(),t("tr",{key:o.id},[e("td",xs,l(a(E)(o.date)),1),Ms,Ss]))],64))),256))])):r("",!0),((P=m.value.data)==null?void 0:P.length)===0?(s(),t("tbody",Ys,ws)):r("",!0)])])])])):r("",!0),g.value?(s(),T(a(O),{key:2,data:m.value,onPaginationChangePage:w,limit:1,keepLength:!0,style:{"margin-bottom":"100px"}},null,8,["data"])):r("",!0),S.value?(s(),t("div",Is,[e("embed",{src:`/preview-lckb/${a(y)}/${a(n).userId}`,width:"100%",height:"600",type:"application/pdf"},null,8,Ls)])):r("",!0)])])])])],64)}}};export{Bs as default};
