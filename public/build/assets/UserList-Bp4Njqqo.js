import{e as m,u as F,E as N,f as h,c as d,o as u,a as t,j as a,v as r,s as A,F as y,H as E,t as n,n as j,i as k,d as C,G as g,l as B,b as G,x as w,I as J}from"./app-CSA2mFh-.js";import{u as H}from"./MasterDataStore-aOYwtC0N.js";import"./LoadingStore-B9qlbHQ0.js";const R={class:"content"},z={class:"container-fluid"},O={class:"card"},W={class:"card-header"},Q={class:"card-body table-responsive p-0"},X={class:"table table-bordered table-hover text-sm"},Y={key:0},Z={key:1},tt=["onClick"],lt={class:"card-footer clearfix"},et={class:"d-flex justify-content-between align-items-center"},ot={class:"text-muted"},at={class:"pagination pagination-sm m-0"},st={class:"page-item disabled"},nt={class:"page-link"},rt={class:"modal fade",id:"userModal",tabindex:"-1",role:"dialog"},it={class:"modal-dialog modal-lg",role:"document"},dt={class:"modal-content"},ut={class:"modal-header py-2"},mt={class:"modal-title",id:"userModalLabel"},pt={class:"modal-body pt-2"},vt={class:"row"},bt={class:"col-md-6"},ft={class:"form-group mb-2"},gt={class:"form-group mb-2"},ct={class:"form-group mb-2"},_t={class:"form-group mb-2"},yt={class:"form-group mb-2"},kt={class:"form-group mb-2"},wt={class:"form-group mb-2"},Ut=["required"],Mt={class:"col-md-6"},Pt={class:"form-group mb-2"},Vt={class:"form-group mb-2"},xt={class:"form-group mb-2"},Tt=["value"],St={class:"form-group mb-2"},Nt={class:"form-group mb-2"},Et={class:"form-group mb-2"},jt={class:"form-group mb-2"},Ct={class:"form-group mb-2"},It={class:"text-end mt-3"},Lt=["disabled"],Dt={key:0,class:"fas fa-spinner fa-spin me-1"},qt={key:1,class:"fas fa-save me-1"},Bt={__name:"UserList",setup(Kt){const b=m(!1),U=H(),I=F(),c=m([]),s=m({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),f=m(""),_=m(!1),p=m(!1),o=m({}),v=async(i=1)=>{_.value=!0;try{const l=await w.get("/api/users",{params:{page:i,search:f.value}});c.value=l.data.data,s.value={...s.value,...l.data.meta,...l.data}}catch(l){l.response&&l.response.status===401?(console.warn("Unauthorized. Logging out..."),I.logout()):console.error("Gagal memuat data pengguna:",l)}finally{_.value=!1}},L=()=>{p.value=!1,o.value={},$("#userModal").modal("show")},D=i=>{var l;p.value=!0,o.value={...i,...i.employee,id_work_unit:(l=i.employee)==null?void 0:l.id_work_unit},$("#userModal").modal("show")},q=async()=>{b.value=!0;try{p.value?await w.put(`/api/users/${o.value.id}`,o.value):await w.post("/api/users",o.value),v(),$("#userModal").modal("hide")}catch(i){alert("Gagal menyimpan data: "+i)}finally{b.value=!1}};return N(f,J(()=>v(1),400)),N(()=>o.nip,i=>{o.username=i}),h(()=>{v(),U.getWorkunitList()}),(i,l)=>(u(),d(y,null,[t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("div",{class:"d-flex justify-content-between align-items-center"},[l[18]||(l[18]=t("h1",{class:"mb-2"},"Daftar Pengguna",-1)),t("button",{class:"btn btn-primary btn-sm",onClick:L},"+ Tambah Pengguna")])])]),t("section",R,[t("div",z,[t("div",O,[t("div",W,[a(t("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),type:"text",class:"form-control",placeholder:"Cari nama, email, NIP, atau unit kerja..."},null,512),[[r,f.value]])]),t("div",Q,[t("table",X,[l[21]||(l[21]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Nama"),t("th",null,"Jabatan"),t("th",null,"NIP"),t("th",null,"Unit Kerja"),t("th",null,"Status"),t("th",null,"Aksi")])],-1)),t("tbody",null,[_.value?(u(),d("tr",Y,l[19]||(l[19]=[t("td",{colspan:"7",class:"text-center"},"Memuat data...",-1)]))):c.value.length===0?(u(),d("tr",Z,l[20]||(l[20]=[t("td",{colspan:"7",class:"text-center"},"Tidak ada data pengguna ditemukan.",-1)]))):A("",!0),(u(!0),d(y,null,E(c.value,(e,K)=>{var M,P,V,x,T,S;return u(),d("tr",{key:e.id},[t("td",null,n(K+1+(s.value.current_page-1)*s.value.per_page),1),t("td",null,[t("strong",null,n(((M=e.employee)==null?void 0:M.full_name)||e.name),1)]),t("td",null,n(((P=e.employee)==null?void 0:P.job_title)||"-"),1),t("td",null,n(((V=e.employee)==null?void 0:V.nip)||"-"),1),t("td",null,n(((T=(x=e.employee)==null?void 0:x.work_unit)==null?void 0:T.unit_name)||"-"),1),t("td",null,n(((S=e.employee)==null?void 0:S.employment_status)||"-"),1),t("td",null,[t("button",{class:"btn btn-sm btn-warning mr-1",onClick:$t=>D(e)},"Edit",8,tt)])])}),128))])])]),t("div",lt,[t("div",et,[t("div",ot," Menampilkan "+n(s.value.from)+" - "+n(s.value.to)+" dari "+n(s.value.total)+" pengguna ",1),t("ul",at,[t("li",{class:j(["page-item",{disabled:s.value.current_page===1}])},[t("a",{class:"page-link",href:"#",onClick:l[1]||(l[1]=k(e=>v(s.value.current_page-1),["prevent"]))},"«")],2),t("li",st,[t("span",nt," Halaman "+n(s.value.current_page)+" / "+n(s.value.last_page),1)]),t("li",{class:j(["page-item",{disabled:s.value.current_page===s.value.last_page}])},[t("a",{class:"page-link",href:"#",onClick:l[2]||(l[2]=k(e=>v(s.value.current_page+1),["prevent"]))},"»")],2)])])])])]),t("div",rt,[t("div",it,[t("div",dt,[t("div",ut,[t("h5",mt,[l[22]||(l[22]=t("i",{class:"fas fa-user-edit me-2"},null,-1)),C(n(p.value?"Edit Pengguna":"Tambah Pengguna"),1)]),l[23]||(l[23]=t("button",{type:"button",class:"close","data-dismiss":"modal"},[t("span",null,"×")],-1))]),t("div",pt,[t("form",{onSubmit:k(q,["prevent"])},[t("div",vt,[t("div",bt,[t("div",ft,[l[24]||(l[24]=t("label",{class:"mb-1"},"Nama Lengkap",-1)),a(t("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>o.value.full_name=e),class:"form-control form-control-sm",required:"",readonly:""},null,512),[[r,o.value.full_name]])]),t("div",gt,[l[25]||(l[25]=t("label",{class:"mb-1"},"Email",-1)),a(t("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>o.value.email=e),type:"email",class:"form-control form-control-sm",readonly:""},null,512),[[r,o.value.email]])]),t("div",ct,[l[26]||(l[26]=t("label",{class:"mb-1"},"NIP",-1)),a(t("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>o.value.nip=e),class:"form-control form-control-sm",required:"",readonly:""},null,512),[[r,o.value.nip]])]),t("div",_t,[l[27]||(l[27]=t("label",{class:"mb-1"},"Tanggal Lahir",-1)),a(t("input",{"onUpdate:modelValue":l[6]||(l[6]=e=>o.value.date_of_birth=e),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[r,o.value.date_of_birth]])]),t("div",yt,[l[29]||(l[29]=t("label",{class:"mb-1"},"Jenis Kelamin",-1)),a(t("select",{"onUpdate:modelValue":l[7]||(l[7]=e=>o.value.gender=e),class:"form-control form-control-sm",readonly:""},l[28]||(l[28]=[t("option",{value:"M"},"Laki-laki",-1),t("option",{value:"F"},"Perempuan",-1)]),512),[[g,o.value.gender]])]),t("div",kt,[l[30]||(l[30]=t("label",{class:"mb-1"},"No. HP",-1)),a(t("input",{"onUpdate:modelValue":l[8]||(l[8]=e=>o.value.phone_number=e),class:"form-control form-control-sm"},null,512),[[r,o.value.phone_number]])]),t("div",wt,[l[31]||(l[31]=t("label",{class:"mb-1"},"Password",-1)),a(t("input",{"onUpdate:modelValue":l[9]||(l[9]=e=>o.value.password=e),type:"password",class:"form-control form-control-sm",required:!p.value},null,8,Ut),[[r,o.value.password]])])]),t("div",Mt,[t("div",Pt,[l[32]||(l[32]=t("label",{class:"mb-1"},"Jabatan",-1)),a(t("input",{"onUpdate:modelValue":l[10]||(l[10]=e=>o.value.job_title=e),class:"form-control form-control-sm",required:"",readonly:""},null,512),[[r,o.value.job_title]])]),t("div",Vt,[l[33]||(l[33]=t("label",{class:"mb-1"},"Gol. Ruang",-1)),a(t("input",{"onUpdate:modelValue":l[11]||(l[11]=e=>o.value.gol_ruang=e),class:"form-control form-control-sm",placeholder:"Contoh: III/b",required:"",readonly:""},null,512),[[r,o.value.gol_ruang]])]),t("div",xt,[l[34]||(l[34]=t("label",{class:"mb-1"},"Unit Kerja",-1)),a(t("select",{"onUpdate:modelValue":l[12]||(l[12]=e=>o.value.id_work_unit=e),class:"form-control form-control-sm",readonly:"",required:""},[(u(!0),d(y,null,E(B(U).workunitList,e=>(u(),d("option",{key:e.id,value:e.id},n(e.text),9,Tt))),128))],512),[[g,o.value.id_work_unit]])]),t("div",St,[l[36]||(l[36]=t("label",{class:"mb-1"},"Status Kepegawaian",-1)),a(t("select",{"onUpdate:modelValue":l[13]||(l[13]=e=>o.value.employment_status=e),class:"form-control form-control-sm",readonly:"",required:""},l[35]||(l[35]=[t("option",{value:"PNS"},"PNS",-1),t("option",{value:"PPPK"},"PPPK",-1)]),512),[[g,o.value.employment_status]])]),t("div",Nt,[l[37]||(l[37]=t("label",{class:"mb-1"},"TMT Pangkat",-1)),a(t("input",{"onUpdate:modelValue":l[14]||(l[14]=e=>o.value.tmt_pangkat=e),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[r,o.value.tmt_pangkat]])]),t("div",Et,[l[38]||(l[38]=t("label",{class:"mb-1"},"TMT Jabatan",-1)),a(t("input",{"onUpdate:modelValue":l[15]||(l[15]=e=>o.value.tmt_jabatan=e),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[r,o.value.tmt_jabatan]])]),t("div",jt,[l[39]||(l[39]=t("label",{class:"mb-1"},"TMT Pensiun",-1)),a(t("input",{"onUpdate:modelValue":l[16]||(l[16]=e=>o.value.tmt_pensiun=e),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[r,o.value.tmt_pensiun]])]),t("div",Ct,[l[41]||(l[41]=t("label",{class:"mb-1"},"Kategori Kepegawaian",-1)),a(t("select",{"onUpdate:modelValue":l[17]||(l[17]=e=>o.value.employment_category=e),class:"form-control form-control-sm"},l[40]||(l[40]=[G('<option value="ACTIVE">Aktif</option><option value="RETIRED">Pensiun</option><option value="LEFT">Berhenti</option><option value="DIED">Meninggal</option><option value="MUTATION">Mutasi</option>',5)]),512),[[g,o.value.employment_category]])])])]),t("div",It,[t("button",{type:"submit",class:"btn btn-sm btn-primary",disabled:b.value},[b.value?(u(),d("i",Dt)):(u(),d("i",qt)),l[42]||(l[42]=C(" Simpan "))],8,Lt)])],32)])])])])])],64))}};export{Bt as default};
