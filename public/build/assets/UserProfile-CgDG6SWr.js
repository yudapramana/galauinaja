import{y as G,u as $,r as f,h as q,f as O,c as n,o as r,a as s,s as d,m as a,t as i,b as K,j as w,k as m,v as p,D as y,F,C as Q,d as x}from"./app-DTEj2a-1.js";import{u as X}from"./toastr-BoqbSObC.js";import{u as Y}from"./MasterDataStore-CJI4vXE1.js";import"./LoadingStore-NV62QM8A.js";const Z={class:"content-header"},ee={class:"container-fluid"},se={class:"row mb-2"},oe={key:0,class:"col-sm-6"},le={class:"content"},te={class:"container-fluid"},ae={class:"row",style:{"margin-bottom":"100px"}},ne={class:"col-md-3"},re={class:"card card-primary card-outline"},ie={class:"card-body box-profile"},de={class:"text-center"},me=["src"],ue={class:"profile-username text-center"},pe={class:"text-muted text-center text-sm"},ce={class:"col-md-9"},fe={class:"card"},be={class:"card-body"},ve={class:"tab-content"},_e={class:"tab-pane active",id:"profile"},ye={class:"col-md-6"},ge={key:0,class:"text-danger text-sm"},we={class:"col-md-6"},xe={key:0,class:"text-danger text-sm"},ke={class:"col-md-6"},Pe={key:0,class:"text-danger text-sm"},he={class:"col-md-6"},Ue={key:0,class:"text-danger text-sm"},Ve={class:"col-md-6"},Ce={key:0,class:"text-danger text-sm"},Se={class:"col-md-6"},je={key:0,class:"text-danger text-sm"},Ne={class:"col-md-6"},Te={key:0,class:"text-danger text-sm"},De={class:"col-md-6"},Me={key:0,class:"text-danger text-sm"},Le={class:"col-md-6"},Ee=["value"],Ie={key:0,class:"text-danger text-sm"},Ke={class:"col-md-6"},Fe={key:0,class:"text-danger text-sm"},Ae={class:"col-md-6"},Be={key:0,class:"text-danger text-sm"},Je={class:"col-md-6"},Re={key:0,class:"text-danger text-sm"},We={class:"col-md-6"},He={key:0,class:"text-danger text-sm"},ze={class:"col-md-6"},Ge={key:0,class:"text-danger text-sm"},$e={class:"col-12"},qe=["disabled"],Oe={key:0,class:"fa fa-spinner fa-spin me-1"},Qe={key:1,class:"fa fa-save me-1"},Xe={class:"tab-pane",id:"changePassword"},Ye={class:"form-group row"},Ze={class:"col-sm-9"},es={key:0,class:"text-danger text-sm"},ss={class:"form-group row"},os={class:"col-sm-9"},ls={key:0,class:"text-danger text-sm"},ts={class:"form-group row"},as={class:"col-sm-9"},ns={class:"form-group row"},rs={class:"offset-sm-3 col-sm-9"},is=["disabled"],ds={key:0,class:"fa fa-spinner fa-spin mr-1"},ms={key:1,class:"fa fa-save mr-1"},vs={__name:"UserProfile",setup(us){const A=G(),o=$(),k=Y(),b=X(),t=f([]),g=f(""),v=f(!1),_=f(!1),B=window.cloudinary.createUploadWidget({cloud_name:"pesselkemenag",upload_preset:"profile_picture"},(u,e)=>{!u&&e&&e.event==="success"&&(g.value=e.info.secure_url),!u&&e&&e.event=="close"&&H()});function J(){B.open()}const R=()=>{v.value=!0,axios.put("/api/profile",{nip:o.user.employee.nip,full_name:o.user.employee.full_name,date_of_birth:o.user.employee.date_of_birth,gender:o.user.employee.gender,phone_number:o.user.employee.phone_number,email:o.user.employee.email,job_title:o.user.employee.job_title,id_work_unit:o.user.employee.id_work_unit,employment_status:o.user.employee.employment_status,tmt_pangkat:o.user.employee.tmt_pangkat,tmt_jabatan:o.user.employee.tmt_jabatan}).then(u=>{b.success("Profile updated successfully!")}).catch(u=>{u.response&&u.response.status===422&&(t.value=u.response.data.errors)}).finally(()=>{v.value=!1})},W=()=>{o.logout()};f(null);const H=u=>{g.value!=""?axios.post("/api/upload-profile-image",{profile_picture:g.value}).then(e=>{o.getAuthUser(),b.success("Image uploaded successfully!")}):b.error("Image failed to upload!")},c=q({currentPassword:"",password:"",passwordConfirmation:""}),z=()=>{_.value=!0,t.value="",axios.post("/api/change-user-password",c).then(u=>{b.success(u.data.message);for(const e in c)c[e]=""}).catch(u=>{u.response&&u.response.status===422&&(t.value=u.response.data.errors)}).finally(()=>{_.value=!1})};return O(()=>{k.getWorkunitList()}),(u,e)=>{var P,h,U,V,C,S,j,N,T,D,M,L,E,I;return r(),n(F,null,[s("div",Z,[s("div",ee,[s("div",se,[e[19]||(e[19]=s("div",{class:"col-sm-6"},[s("h1",{class:"m-0"},"Profile")],-1)),a(A).isMobile?d("",!0):(r(),n("div",oe,e[18]||(e[18]=[s("ol",{class:"breadcrumb float-sm-right"},[s("li",{class:"breadcrumb-item"},[s("a",{href:"#"},"Home")]),s("li",{class:"breadcrumb-item active"},"Profile")],-1)])))])])]),s("div",le,[s("div",te,[s("div",ae,[s("div",ne,[s("div",re,[s("div",ie,[s("div",de,[s("img",{onClick:J,class:"profile-user-img img-circle",src:a(o).user.avatar,alt:"User profile picture"},null,8,me)]),s("h3",ue,i(a(o).user.employee.full_name),1),s("p",pe,i(a(o).user.employee.job_title),1)])])]),s("div",ce,[s("div",fe,[e[46]||(e[46]=K('<div class="card-header p-2"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" href="#profile" data-toggle="tab"><i class="fa fa-user mr-1"></i> Edit Profile</a></li><li class="nav-item"><a class="nav-link" href="#changePassword" data-toggle="tab"><i class="fa fa-key mr-1"></i> Change Password</a></li></ul></div>',1)),s("div",be,[s("div",ve,[s("div",_e,[s("form",{onSubmit:e[14]||(e[14]=w(l=>R(),["prevent"])),class:"row g-3"},[s("div",ye,[e[20]||(e[20]=s("label",{class:"form-label small fw-semibold mb-1"},"NIP (Nomor Induk Pegawai)",-1)),m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).user.employee.nip=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.nip]]),(P=t.value)!=null&&P.nip?(r(),n("span",ge,i(t.value.nip[0]),1)):d("",!0)]),s("div",we,[e[21]||(e[21]=s("label",{class:"form-label small fw-semibold mb-1"},"Nama Lengkap",-1)),m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a(o).user.employee.full_name=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.full_name]]),(h=t.value)!=null&&h.full_name?(r(),n("span",xe,i(t.value.full_name[0]),1)):d("",!0)]),s("div",ke,[e[22]||(e[22]=s("label",{class:"form-label small fw-semibold mb-1"},"Tanggal Lahir",-1)),m(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).user.employee.date_of_birth=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.date_of_birth]]),(U=t.value)!=null&&U.date_of_birth?(r(),n("span",Pe,i(t.value.date_of_birth[0]),1)):d("",!0)]),s("div",he,[e[24]||(e[24]=s("label",{class:"form-label small fw-semibold mb-1"},"Jenis Kelamin",-1)),m(s("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).user.employee.gender=l),class:"form-control form-control-sm",disabled:""},e[23]||(e[23]=[s("option",{value:""},"Pilih",-1),s("option",{value:"M"},"Laki-laki",-1),s("option",{value:"F"},"Perempuan",-1)]),512),[[y,a(o).user.employee.gender]]),(V=t.value)!=null&&V.gender?(r(),n("span",Ue,i(t.value.gender[0]),1)):d("",!0)]),s("div",Ve,[e[25]||(e[25]=s("label",{class:"form-label small fw-semibold mb-1"},"Nomor HP",-1)),m(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a(o).user.employee.phone_number=l),type:"text",class:"form-control form-control-sm",placeholder:"08xxxx"},null,512),[[p,a(o).user.employee.phone_number]]),(C=t.value)!=null&&C.phone_number?(r(),n("span",Ce,i(t.value.phone_number[0]),1)):d("",!0)]),s("div",Se,[e[26]||(e[26]=s("label",{class:"form-label small fw-semibold mb-1"},"Email",-1)),m(s("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a(o).user.employee.email=l),type:"email",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.email]]),(S=t.value)!=null&&S.email?(r(),n("span",je,i(t.value.email[0]),1)):d("",!0)]),s("div",Ne,[e[27]||(e[27]=s("label",{class:"form-label small fw-semibold mb-1"},"Golongan / Ruang",-1)),m(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>a(o).user.employee.gol_ruang=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.gol_ruang]]),(j=t.value)!=null&&j.gol_ruang?(r(),n("span",Te,i(t.value.gol_ruang[0]),1)):d("",!0)]),s("div",De,[e[28]||(e[28]=s("label",{class:"form-label small fw-semibold mb-1"},"Jabatan",-1)),m(s("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>a(o).user.employee.job_title=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.job_title]]),(N=t.value)!=null&&N.job_title?(r(),n("span",Me,i(t.value.job_title[0]),1)):d("",!0)]),s("div",Le,[e[30]||(e[30]=s("label",{class:"form-label small fw-semibold mb-1"},"Unit Kerja",-1)),m(s("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>a(o).user.employee.id_work_unit=l),class:"form-control form-control-sm",disabled:""},[e[29]||(e[29]=s("option",{value:""},"Pilih Unit Kerja",-1)),(r(!0),n(F,null,Q(a(k).workunitList,l=>(r(),n("option",{key:l.id,value:l.id},i(l.text),9,Ee))),128))],512),[[y,a(o).user.employee.id_work_unit]]),(T=t.value)!=null&&T.id_work_unit?(r(),n("span",Ie,i(t.value.id_work_unit[0]),1)):d("",!0)]),s("div",Ke,[e[32]||(e[32]=s("label",{class:"form-label small fw-semibold mb-1"},"Status Kepegawaian",-1)),m(s("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>a(o).user.employee.employment_status=l),class:"form-control form-control-sm",disabled:""},e[31]||(e[31]=[s("option",{value:""},"Pilih",-1),s("option",{value:"PNS"},"PNS",-1),s("option",{value:"PPPK"},"PPPK",-1)]),512),[[y,a(o).user.employee.employment_status]]),(D=t.value)!=null&&D.employment_status?(r(),n("span",Fe,i(t.value.employment_status[0]),1)):d("",!0)]),s("div",Ae,[e[33]||(e[33]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Pangkat",-1)),m(s("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>a(o).user.employee.tmt_pangkat=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.tmt_pangkat]]),(M=t.value)!=null&&M.tmt_pangkat?(r(),n("span",Be,i(t.value.tmt_pangkat[0]),1)):d("",!0)]),s("div",Je,[e[34]||(e[34]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Jabatan",-1)),m(s("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>a(o).user.employee.tmt_jabatan=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.tmt_jabatan]]),(L=t.value)!=null&&L.tmt_jabatan?(r(),n("span",Re,i(t.value.tmt_jabatan[0]),1)):d("",!0)]),s("div",We,[e[35]||(e[35]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Pensiun",-1)),m(s("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>a(o).user.employee.tmt_pensiun=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.tmt_pensiun]]),(E=t.value)!=null&&E.tmt_pensiun?(r(),n("span",He,i(t.value.tmt_pensiun[0]),1)):d("",!0)]),s("div",ze,[e[37]||(e[37]=s("label",{class:"form-label small fw-semibold mb-1"},"Kategori",-1)),m(s("select",{"onUpdate:modelValue":e[13]||(e[13]=l=>a(o).user.employee.employment_category=l),class:"form-control form-control-sm",disabled:""},e[36]||(e[36]=[K('<option value="">Pilih</option><option value="ACTIVE">Aktif</option><option value="RETIRED">Pensiun</option><option value="LEFT">Berhenti</option><option value="DIED">Meninggal Dunia</option>',5)]),512),[[y,a(o).user.employee.employment_category]]),(I=t.value)!=null&&I.employment_category?(r(),n("span",Ge,i(t.value.gender[0]),1)):d("",!0)]),e[40]||(e[40]=s("hr",null,null,-1)),s("div",$e,[e[39]||(e[39]=s("hr",null,null,-1)),s("button",{type:"submit",class:"btn btn-success btn-sm",disabled:v.value},[v.value?(r(),n("i",Oe)):(r(),n("i",Qe)),e[38]||(e[38]=x(" Simpan Perubahan "))],8,qe)])],32)]),s("div",Xe,[s("form",{onSubmit:w(z,["prevent"]),class:"form-horizontal"},[s("div",Ye,[e[41]||(e[41]=s("label",{for:"currentPassword",class:"col-sm-3 col-form-label"},"Current Password",-1)),s("div",Ze,[m(s("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>c.currentPassword=l),type:"password",class:"form-control",id:"currentPassword",placeholder:"Current Password"},null,512),[[p,c.currentPassword]]),t.value&&t.value.current_password?(r(),n("span",es,i(t.value.current_password[0]),1)):d("",!0)])]),s("div",ss,[e[42]||(e[42]=s("label",{for:"newPassword",class:"col-sm-3 col-form-label"},"New Password",-1)),s("div",os,[m(s("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>c.password=l),type:"password",class:"form-control",id:"newPassword",placeholder:"New Password"},null,512),[[p,c.password]]),t.value&&t.value.password?(r(),n("span",ls,i(t.value.password[0]),1)):d("",!0)])]),s("div",ts,[e[43]||(e[43]=s("label",{for:"passwordConfirmation",class:"col-sm-3 col-form-label"},"Confirm New Password",-1)),s("div",as,[m(s("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>c.passwordConfirmation=l),type:"password",class:"form-control",id:"passwordConfirmation",placeholder:"Confirm New Password"},null,512),[[p,c.passwordConfirmation]])])]),s("div",ns,[s("div",rs,[s("button",{type:"submit",class:"btn btn-success",disabled:_.value},[_.value?(r(),n("i",ds)):(r(),n("i",ms)),e[44]||(e[44]=x(" Save Changes "))],8,is)])])],32)])])]),s("button",{onClick:w(W,["prevent"]),type:"button",class:"btn btn-danger btn-block"},e[45]||(e[45]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),x(" Logout")]))])])])])])],64)}}};export{vs as default};
