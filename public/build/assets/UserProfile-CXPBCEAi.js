import{m as M,u as T,f as _,r as F,s as D,c as r,a as e,p as a,k as u,t as i,d as L,h as g,i as m,v as p,z as w,F as x,x as W,b as h,o as n}from"./app-BpeXRWRP.js";import{u as B}from"./toastr-DFBXLYzF.js";import{u as E}from"./MasterDataStore-tlWQTJoC.js";import"./LoadingStore-pSFzAoZq.js";const I={class:"content-header"},z={class:"container-fluid"},J={class:"row mb-2"},A={key:0,class:"col-sm-6"},K={class:"content"},G={class:"container-fluid"},H={class:"row",style:{"margin-bottom":"100px"}},$={class:"col-md-3"},q={class:"card card-primary card-outline"},O={class:"card-body box-profile"},Q={class:"text-center"},R=["src"],X={class:"profile-username text-center"},Y={class:"text-muted text-center text-sm"},Z={class:"col-md-9"},ee={class:"card"},se={class:"card-body"},oe={class:"tab-content"},te={class:"tab-pane active",id:"profile"},le={class:"form-group row"},ae={class:"col-sm-10"},re={key:0,class:"text-danger text-sm"},ne={class:"form-group row"},ie={class:"col-sm-10"},de={key:0,class:"text-danger text-sm"},ue={class:"form-group row"},me={class:"col-sm-10"},pe={key:0,class:"text-danger text-sm"},ce={class:"form-group row"},_e={class:"col-sm-10"},fe={key:0,class:"text-danger text-sm"},ve={class:"form-group row"},ye={class:"col-sm-10"},be={key:0,class:"text-danger text-sm"},ge={class:"form-group row"},we={class:"col-sm-10"},he={key:0,class:"text-danger text-sm"},ke={class:"form-group row"},xe={class:"col-sm-10"},Pe={key:0,class:"text-danger text-sm"},Ue={class:"form-group row"},Se={class:"col-sm-10"},Ce=["value"],Ve={key:0,class:"text-danger text-sm"},Ne={class:"form-group row"},je={class:"col-sm-10"},Me={key:0,class:"text-danger text-sm"},Te={class:"form-group row"},Fe={class:"col-sm-10"},De={key:0,class:"text-danger text-sm"},Le={class:"form-group row"},We={class:"col-sm-10"},Be={key:0,class:"text-danger text-sm"},Ee={class:"form-group row"},Ie={class:"offset-sm-2 col-sm-10"},ze=["disabled"],Je={key:0,class:"fa fa-spinner fa-spin mr-1"},Ae={key:1,class:"fa fa-save mr-1"},Ke={class:"tab-pane",id:"changePassword"},Ge={class:"form-group row"},He={class:"col-sm-9"},$e={key:0,class:"text-danger text-sm"},qe={class:"form-group row"},Oe={class:"col-sm-9"},Qe={key:0,class:"text-danger text-sm"},Re={class:"form-group row"},Xe={class:"col-sm-9"},Ye={class:"form-group row"},Ze={class:"offset-sm-3 col-sm-9"},es=["disabled"],ss={key:0,class:"fa fa-spinner fa-spin mr-1"},os={key:1,class:"fa fa-save mr-1"},is={__name:"UserProfile",setup(ts){const P=M(),t=T(),k=E(),f=B(),o=_([]),b=_(""),v=_(!1),y=_(!1),U=window.cloudinary.createUploadWidget({cloud_name:"kemenagpessel",upload_preset:"profile_picture_pegawai"},(d,s)=>{!d&&s&&s.event==="success"&&(b.value=s.info.secure_url),!d&&s&&s.event=="close"&&N()});function S(){U.open()}const C=()=>{v.value=!0,axios.put("/api/profile",{nip:t.user.employee.nip,full_name:t.user.employee.full_name,date_of_birth:t.user.employee.date_of_birth,gender:t.user.employee.gender,phone_number:t.user.employee.phone_number,email:t.user.employee.email,job_title:t.user.employee.job_title,id_work_unit:t.user.employee.id_work_unit,employment_status:t.user.employee.employment_status,tmt_pangkat:t.user.employee.tmt_pangkat,tmt_jabatan:t.user.employee.tmt_jabatan}).then(d=>{f.success("Profile updated successfully!")}).catch(d=>{d.response&&d.response.status===422&&(o.value=d.response.data.errors)}).finally(()=>{v.value=!1})},V=()=>{t.logout()};_(null);const N=d=>{b.value!=""?axios.post("/api/upload-profile-image",{profile_picture:b.value}).then(s=>{t.getAuthUser(),f.success("Image uploaded successfully!")}):f.error("Image failed to upload!")},c=F({currentPassword:"",password:"",passwordConfirmation:""}),j=()=>{y.value=!0,o.value="",axios.post("/api/change-user-password",c).then(d=>{f.success(d.data.message);for(const s in c)c[s]=""}).catch(d=>{d.response&&d.response.status===422&&(o.value=d.response.data.errors)}).finally(()=>{y.value=!1})};return D(()=>{k.getWorkunitList()}),(d,s)=>(n(),r(x,null,[e("div",I,[e("div",z,[e("div",J,[s[16]||(s[16]=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"Profile")],-1)),a(P).isMobile?u("",!0):(n(),r("div",A,s[15]||(s[15]=[e("ol",{class:"breadcrumb float-sm-right"},[e("li",{class:"breadcrumb-item"},[e("a",{href:"#"},"Home")]),e("li",{class:"breadcrumb-item active"},"Profile")],-1)])))])])]),e("div",K,[e("div",G,[e("div",H,[e("div",$,[e("div",q,[e("div",O,[e("div",Q,[e("img",{onClick:S,class:"profile-user-img img-circle",src:a(t).user.avatar,alt:"User profile picture"},null,8,R)]),e("h3",X,i(a(t).user.employee.full_name),1),e("p",Y,i(a(t).user.employee.job_title),1)])])]),e("div",Z,[e("div",ee,[s[37]||(s[37]=L('<div class="card-header p-2"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" href="#profile" data-toggle="tab"><i class="fa fa-user mr-1"></i> Edit Profile</a></li><li class="nav-item"><a class="nav-link" href="#changePassword" data-toggle="tab"><i class="fa fa-key mr-1"></i> Change Password</a></li></ul></div>',1)),e("div",se,[e("div",oe,[e("div",te,[e("form",{onSubmit:s[11]||(s[11]=g(l=>C(),["prevent"])),class:"form-horizontal"},[e("div",le,[s[17]||(s[17]=e("label",{class:"col-sm-2 col-form-label"},"NIP",-1)),e("div",ae,[m(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>a(t).user.employee.nip=l),type:"text",class:"form-control",placeholder:"NIP",readonly:""},null,512),[[p,a(t).user.employee.nip]]),o.value&&o.value.nip?(n(),r("span",re,i(o.value.nip[0]),1)):u("",!0)])]),e("div",ne,[s[18]||(s[18]=e("label",{class:"col-sm-2 col-form-label"},"Full Name",-1)),e("div",ie,[m(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>a(t).user.employee.full_name=l),type:"text",class:"form-control",placeholder:"Full Name",readonly:""},null,512),[[p,a(t).user.employee.full_name]]),o.value&&o.value.full_name?(n(),r("span",de,i(o.value.full_name[0]),1)):u("",!0)])]),e("div",ue,[s[19]||(s[19]=e("label",{class:"col-sm-2 col-form-label"},"Date of Birth",-1)),e("div",me,[m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>a(t).user.employee.date_of_birth=l),type:"date",class:"form-control",readonly:""},null,512),[[p,a(t).user.employee.date_of_birth]]),o.value&&o.value.date_of_birth?(n(),r("span",pe,i(o.value.date_of_birth[0]),1)):u("",!0)])]),e("div",ce,[s[21]||(s[21]=e("label",{class:"col-sm-2 col-form-label"},"Gender",-1)),e("div",_e,[m(e("select",{"onUpdate:modelValue":s[3]||(s[3]=l=>a(t).user.employee.gender=l),readonly:"",class:"form-control"},s[20]||(s[20]=[e("option",{value:""},"Select",-1),e("option",{value:"M"},"Male",-1),e("option",{value:"F"},"Female",-1)]),512),[[w,a(t).user.employee.gender]]),o.value&&o.value.gender?(n(),r("span",fe,i(o.value.gender[0]),1)):u("",!0)])]),e("div",ve,[s[22]||(s[22]=e("label",{class:"col-sm-2 col-form-label"},"Phone",-1)),e("div",ye,[m(e("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>a(t).user.employee.phone_number=l),type:"text",class:"form-control",placeholder:"Phone Number"},null,512),[[p,a(t).user.employee.phone_number]]),o.value&&o.value.phone_number?(n(),r("span",be,i(o.value.phone_number[0]),1)):u("",!0)])]),e("div",ge,[s[23]||(s[23]=e("label",{class:"col-sm-2 col-form-label"},"Email",-1)),e("div",we,[m(e("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>a(t).user.employee.email=l),type:"email",readonly:"",class:"form-control",placeholder:"Email"},null,512),[[p,a(t).user.employee.email]]),o.value&&o.value.email?(n(),r("span",he,i(o.value.email[0]),1)):u("",!0)])]),e("div",ke,[s[24]||(s[24]=e("label",{class:"col-sm-2 col-form-label"},"Job Title",-1)),e("div",xe,[m(e("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>a(t).user.employee.job_title=l),type:"text",readonly:"",class:"form-control",placeholder:"Job Title"},null,512),[[p,a(t).user.employee.job_title]]),o.value&&o.value.job_title?(n(),r("span",Pe,i(o.value.job_title[0]),1)):u("",!0)])]),e("div",Ue,[s[26]||(s[26]=e("label",{class:"col-sm-2 col-form-label"},"Work Unit",-1)),e("div",Se,[m(e("select",{"onUpdate:modelValue":s[7]||(s[7]=l=>a(t).user.employee.id_work_unit=l),readonly:"",class:"form-control"},[s[25]||(s[25]=e("option",{value:""},"Select Work Unit",-1)),(n(!0),r(x,null,W(a(k).workunitList,l=>(n(),r("option",{key:l.id,value:l.id},i(l.text),9,Ce))),128))],512),[[w,a(t).user.employee.id_work_unit]]),o.value&&o.value.id_work_unit?(n(),r("span",Ve,i(o.value.id_work_unit[0]),1)):u("",!0)])]),e("div",Ne,[s[28]||(s[28]=e("label",{class:"col-sm-2 col-form-label"},"Status",-1)),e("div",je,[m(e("select",{"onUpdate:modelValue":s[8]||(s[8]=l=>a(t).user.employee.employment_status=l),readonly:"",class:"form-control"},s[27]||(s[27]=[e("option",{value:""},"Select",-1),e("option",{value:"PNS"},"PNS",-1),e("option",{value:"PPPK"},"PPPK",-1)]),512),[[w,a(t).user.employee.employment_status]]),o.value&&o.value.employment_status?(n(),r("span",Me,i(o.value.employment_status[0]),1)):u("",!0)])]),e("div",Te,[s[29]||(s[29]=e("label",{class:"col-sm-2 col-form-label"},"TMT Pangkat",-1)),e("div",Fe,[m(e("input",{"onUpdate:modelValue":s[9]||(s[9]=l=>a(t).user.employee.tmt_pangkat=l),type:"date",readonly:"",class:"form-control"},null,512),[[p,a(t).user.employee.tmt_pangkat]]),o.value&&o.value.tmt_pangkat?(n(),r("span",De,i(o.value.tmt_pangkat[0]),1)):u("",!0)])]),e("div",Le,[s[30]||(s[30]=e("label",{class:"col-sm-2 col-form-label"},"TMT Jabatan",-1)),e("div",We,[m(e("input",{"onUpdate:modelValue":s[10]||(s[10]=l=>a(t).user.employee.tmt_jabatan=l),type:"date",readonly:"",class:"form-control"},null,512),[[p,a(t).user.employee.tmt_jabatan]]),o.value&&o.value.tmt_jabatan?(n(),r("span",Be,i(o.value.tmt_jabatan[0]),1)):u("",!0)])]),e("div",Ee,[e("div",Ie,[e("button",{type:"submit",class:"btn btn-success",disabled:v.value},[v.value?(n(),r("i",Je)):(n(),r("i",Ae)),s[31]||(s[31]=h(" Save Changes "))],8,ze)])])],32)]),e("div",Ke,[e("form",{onSubmit:g(j,["prevent"]),class:"form-horizontal"},[e("div",Ge,[s[32]||(s[32]=e("label",{for:"currentPassword",class:"col-sm-3 col-form-label"},"Current Password",-1)),e("div",He,[m(e("input",{"onUpdate:modelValue":s[12]||(s[12]=l=>c.currentPassword=l),type:"password",class:"form-control",id:"currentPassword",placeholder:"Current Password"},null,512),[[p,c.currentPassword]]),o.value&&o.value.current_password?(n(),r("span",$e,i(o.value.current_password[0]),1)):u("",!0)])]),e("div",qe,[s[33]||(s[33]=e("label",{for:"newPassword",class:"col-sm-3 col-form-label"},"New Password",-1)),e("div",Oe,[m(e("input",{"onUpdate:modelValue":s[13]||(s[13]=l=>c.password=l),type:"password",class:"form-control",id:"newPassword",placeholder:"New Password"},null,512),[[p,c.password]]),o.value&&o.value.password?(n(),r("span",Qe,i(o.value.password[0]),1)):u("",!0)])]),e("div",Re,[s[34]||(s[34]=e("label",{for:"passwordConfirmation",class:"col-sm-3 col-form-label"},"Confirm New Password",-1)),e("div",Xe,[m(e("input",{"onUpdate:modelValue":s[14]||(s[14]=l=>c.passwordConfirmation=l),type:"password",class:"form-control",id:"passwordConfirmation",placeholder:"Confirm New Password"},null,512),[[p,c.passwordConfirmation]])])]),e("div",Ye,[e("div",Ze,[e("button",{type:"submit",class:"btn btn-success",disabled:y.value},[y.value?(n(),r("i",ss)):(n(),r("i",os)),s[35]||(s[35]=h(" Save Changes "))],8,es)])])],32)])])]),e("button",{onClick:g(V,["prevent"]),type:"button",class:"btn btn-danger btn-block"},s[36]||(s[36]=[e("i",{class:"fas fa-sign-out-alt"},null,-1),h(" Logout")]))])])])])])],64))}};export{is as default};
