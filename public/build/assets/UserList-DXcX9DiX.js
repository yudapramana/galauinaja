import{r as m,u as B,B as S,f as A,c as d,o as u,a as t,k as a,v as i,s as G,F as k,C as E,t as n,n as j,j as w,d as L,D as f,m as J,x as c,E as H}from"./app-B2sex_JJ.js";import{u as R}from"./MasterDataStore-DP8Ib43F.js";import"./LoadingStore-CTaOfvaj.js";const z={class:"content"},W={class:"container-fluid"},Y={class:"card"},O={class:"card-header"},Q={class:"card-body table-responsive p-0"},X={class:"table table-bordered table-hover text-sm"},Z={key:0},tt={key:1},et=["onClick"],lt=["onClick"],ot={class:"card-footer clearfix"},at={class:"d-flex justify-content-between align-items-center"},st={class:"text-muted"},nt={class:"pagination pagination-sm m-0"},rt={class:"page-item disabled"},it={class:"page-link"},dt={class:"modal fade",id:"userModal",tabindex:"-1",role:"dialog"},ut={class:"modal-dialog modal-lg",role:"document"},mt={class:"modal-content"},pt={class:"modal-header py-2"},vt={class:"modal-title",id:"userModalLabel"},bt={class:"modal-body pt-2"},gt={class:"row"},ft={class:"col-md-6"},ct={class:"form-group mb-2"},_t={class:"form-group mb-2"},yt={class:"form-group mb-2"},kt={class:"form-group mb-2"},wt={class:"form-group mb-2"},Ut={class:"form-group mb-2"},Pt={class:"form-group mb-2"},Vt=["required"],Mt={class:"col-md-6"},xt={class:"form-group mb-2"},Tt={class:"form-group mb-2"},Ct={class:"form-group mb-2"},St=["value"],Et={class:"form-group mb-2"},jt={class:"form-group mb-2"},Lt={class:"form-group mb-2"},Nt={class:"form-group mb-2"},Dt={class:"form-group mb-2"},ht={class:"text-end mt-3"},It=["disabled"],$t={key:0,class:"fas fa-spinner fa-spin me-1"},qt={key:1,class:"fas fa-save me-1"},Gt={__name:"UserList",setup(Kt){const b=m(!1),U=R(),N=B(),_=m([]),s=m({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),g=m(""),y=m(!1),v=m(!1),o=m({}),p=async(r=1)=>{y.value=!0;try{const e=await c.get("/api/users",{params:{page:r,search:g.value}});_.value=e.data.data,s.value={...s.value,...e.data.meta,...e.data}}catch(e){e.response&&e.response.status===401?(console.warn("Unauthorized. Logging out..."),N.logout()):console.error("Gagal memuat data pengguna:",e)}finally{y.value=!1}},D=()=>{v.value=!1,o.value={},$("#userModal").modal("show")},h=r=>{var e;v.value=!0,o.value={...r,...r.employee,id_work_unit:(e=r.employee)==null?void 0:e.id_work_unit},$("#userModal").modal("show")},I=async()=>{b.value=!0;try{v.value?await c.put(`/api/users/${o.value.id}`,o.value):await c.post("/api/users",o.value),p(),$("#userModal").modal("hide")}catch(r){alert("Gagal menyimpan data: "+r)}finally{b.value=!1}},q=async r=>{if(confirm("Yakin ingin menghapus pengguna ini?"))try{await c.delete(`/api/users/${r}`),p()}catch{alert("Gagal menghapus pengguna")}};return S(g,H(()=>p(1),400)),S(()=>o.nip,r=>{o.username=r}),A(()=>{p(),U.getWorkunitList()}),(r,e)=>(u(),d(k,null,[t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("div",{class:"d-flex justify-content-between align-items-center"},[e[18]||(e[18]=t("h1",{class:"mb-2"},"Daftar Pengguna",-1)),t("button",{class:"btn btn-primary btn-sm",onClick:D},"+ Tambah Pengguna")])])]),t("section",z,[t("div",W,[t("div",Y,[t("div",O,[a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),type:"text",class:"form-control",placeholder:"Cari nama, email, NIP, atau unit kerja..."},null,512),[[i,g.value]])]),t("div",Q,[t("table",X,[e[21]||(e[21]=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Nama"),t("th",null,"Jabatan"),t("th",null,"NIP"),t("th",null,"Unit Kerja"),t("th",null,"Status"),t("th",null,"Aksi")])],-1)),t("tbody",null,[y.value?(u(),d("tr",Z,e[19]||(e[19]=[t("td",{colspan:"7",class:"text-center"},"Memuat data...",-1)]))):_.value.length===0?(u(),d("tr",tt,e[20]||(e[20]=[t("td",{colspan:"7",class:"text-center"},"Tidak ada data pengguna ditemukan.",-1)]))):G("",!0),(u(!0),d(k,null,E(_.value,(l,K)=>{var P,V,M,x,T,C;return u(),d("tr",{key:l.id},[t("td",null,n(K+1+(s.value.current_page-1)*s.value.per_page),1),t("td",null,[t("strong",null,n(((P=l.employee)==null?void 0:P.full_name)||l.name),1)]),t("td",null,n(((V=l.employee)==null?void 0:V.job_title)||"-"),1),t("td",null,n(((M=l.employee)==null?void 0:M.nip)||"-"),1),t("td",null,n(((T=(x=l.employee)==null?void 0:x.work_unit)==null?void 0:T.unit_name)||"-"),1),t("td",null,n(((C=l.employee)==null?void 0:C.employment_status)||"-"),1),t("td",null,[t("button",{class:"btn btn-sm btn-warning mr-1",onClick:F=>h(l)},"Edit",8,et),t("button",{class:"btn btn-sm btn-danger",onClick:F=>q(l.id)},"Hapus",8,lt)])])}),128))])])]),t("div",ot,[t("div",at,[t("div",st," Menampilkan "+n(s.value.from)+" - "+n(s.value.to)+" dari "+n(s.value.total)+" pengguna ",1),t("ul",nt,[t("li",{class:j(["page-item",{disabled:s.value.current_page===1}])},[t("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=w(l=>p(s.value.current_page-1),["prevent"]))},"«")],2),t("li",rt,[t("span",it," Halaman "+n(s.value.current_page)+" / "+n(s.value.last_page),1)]),t("li",{class:j(["page-item",{disabled:s.value.current_page===s.value.last_page}])},[t("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=w(l=>p(s.value.current_page+1),["prevent"]))},"»")],2)])])])])]),t("div",dt,[t("div",ut,[t("div",mt,[t("div",pt,[t("h5",vt,[e[22]||(e[22]=t("i",{class:"fas fa-user-edit me-2"},null,-1)),L(n(v.value?"Edit Pengguna":"Tambah Pengguna"),1)]),e[23]||(e[23]=t("button",{type:"button",class:"close","data-dismiss":"modal"},[t("span",null,"×")],-1))]),t("div",bt,[t("form",{onSubmit:w(I,["prevent"])},[t("div",gt,[t("div",ft,[t("div",ct,[e[24]||(e[24]=t("label",{class:"mb-1"},"Nama Lengkap",-1)),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.full_name=l),class:"form-control form-control-sm",required:"",readonly:""},null,512),[[i,o.value.full_name]])]),t("div",_t,[e[25]||(e[25]=t("label",{class:"mb-1"},"Email",-1)),a(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.email=l),type:"email",class:"form-control form-control-sm",readonly:""},null,512),[[i,o.value.email]])]),t("div",yt,[e[26]||(e[26]=t("label",{class:"mb-1"},"NIP",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.nip=l),class:"form-control form-control-sm",required:"",readonly:""},null,512),[[i,o.value.nip]])]),t("div",kt,[e[27]||(e[27]=t("label",{class:"mb-1"},"Tanggal Lahir",-1)),a(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.date_of_birth=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[i,o.value.date_of_birth]])]),t("div",wt,[e[29]||(e[29]=t("label",{class:"mb-1"},"Jenis Kelamin",-1)),a(t("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.gender=l),class:"form-control form-control-sm",readonly:""},e[28]||(e[28]=[t("option",{value:"M"},"Laki-laki",-1),t("option",{value:"F"},"Perempuan",-1)]),512),[[f,o.value.gender]])]),t("div",Ut,[e[30]||(e[30]=t("label",{class:"mb-1"},"No. HP",-1)),a(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.phone_number=l),class:"form-control form-control-sm"},null,512),[[i,o.value.phone_number]])]),t("div",Pt,[e[31]||(e[31]=t("label",{class:"mb-1"},"Password",-1)),a(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.password=l),type:"password",class:"form-control form-control-sm",required:!v.value},null,8,Vt),[[i,o.value.password]])])]),t("div",Mt,[t("div",xt,[e[32]||(e[32]=t("label",{class:"mb-1"},"Jabatan",-1)),a(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.job_title=l),class:"form-control form-control-sm",required:"",readonly:""},null,512),[[i,o.value.job_title]])]),t("div",Tt,[e[33]||(e[33]=t("label",{class:"mb-1"},"Gol. Ruang",-1)),a(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.gol_ruang=l),class:"form-control form-control-sm",placeholder:"Contoh: III/b",required:"",readonly:""},null,512),[[i,o.value.gol_ruang]])]),t("div",Ct,[e[34]||(e[34]=t("label",{class:"mb-1"},"Unit Kerja",-1)),a(t("select",{"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.id_work_unit=l),class:"form-control form-control-sm",readonly:"",required:""},[(u(!0),d(k,null,E(J(U).workunitList,l=>(u(),d("option",{key:l.id,value:l.id},n(l.text),9,St))),128))],512),[[f,o.value.id_work_unit]])]),t("div",Et,[e[36]||(e[36]=t("label",{class:"mb-1"},"Status Kepegawaian",-1)),a(t("select",{"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.employment_status=l),class:"form-control form-control-sm",readonly:"",required:""},e[35]||(e[35]=[t("option",{value:"PNS"},"PNS",-1),t("option",{value:"PPPK"},"PPPK",-1)]),512),[[f,o.value.employment_status]])]),t("div",jt,[e[37]||(e[37]=t("label",{class:"mb-1"},"TMT Pangkat",-1)),a(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>o.value.tmt_pangkat=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[i,o.value.tmt_pangkat]])]),t("div",Lt,[e[38]||(e[38]=t("label",{class:"mb-1"},"TMT Jabatan",-1)),a(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.tmt_jabatan=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[i,o.value.tmt_jabatan]])]),t("div",Nt,[e[39]||(e[39]=t("label",{class:"mb-1"},"TMT Pensiun",-1)),a(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>o.value.tmt_pensiun=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[i,o.value.tmt_pensiun]])]),t("div",Dt,[e[41]||(e[41]=t("label",{class:"mb-1"},"Kategori Kepegawaian",-1)),a(t("select",{"onUpdate:modelValue":e[17]||(e[17]=l=>o.value.employment_category=l),class:"form-control form-control-sm"},e[40]||(e[40]=[t("option",{value:"ACTIVE"},"Aktif",-1),t("option",{value:"RETIRED"},"Pensiun",-1),t("option",{value:"LEFT"},"Berhenti",-1),t("option",{value:"DIED"},"Meninggal",-1)]),512),[[f,o.value.employment_category]])])])]),t("div",ht,[t("button",{type:"submit",class:"btn btn-sm btn-primary",disabled:b.value},[b.value?(u(),d("i",$t)):(u(),d("i",qt)),e[42]||(e[42]=L(" Simpan "))],8,It)])],32)])])])])])],64))}};export{Gt as default};
