import{c,a as B,A as j,x as J,d,f as t,h as i,v as r,j as G,F as g,B as S,t as l,C as N,g as y,l as T,D as k,z as I,m as b,o as u,E as z}from"./app-CZjyxVNa.js";const A=t("h1",{class:"mb-2"},"Daftar Pengguna",-1),H={class:"content"},W={class:"container-fluid"},Y={class:"card"},O={class:"card-header"},Q={class:"card-body table-responsive p-0"},R={class:"table table-bordered table-hover text-sm"},X=t("thead",{class:"thead-light"},[t("tr",null,[t("th",{style:{width:"40px"}},"#"),t("th",null,"Nama"),t("th",null,"Jabatan"),t("th",null,"NIP"),t("th",null,"Unit Kerja"),t("th",null,"Status"),t("th",null,"Aksi")])],-1),Z={key:0},tt=t("td",{colspan:"7",class:"text-center"},"Memuat data...",-1),et=[tt],st={key:1},at=t("td",{colspan:"7",class:"text-center"},"Tidak ada data pengguna ditemukan.",-1),ot=[at],lt=["onClick"],nt=["onClick"],it={class:"card-footer clearfix"},dt={class:"d-flex justify-content-between align-items-center"},rt={class:"text-muted"},ut={class:"pagination pagination-sm m-0"},ct={class:"page-item disabled"},mt={class:"page-link"},_t={class:"modal fade",id:"userModal",tabindex:"-1",role:"dialog"},pt={class:"modal-dialog modal-lg",role:"document"},vt={class:"modal-content"},bt={class:"modal-header py-2"},ft={class:"modal-title",id:"userModalLabel"},ht=t("i",{class:"fas fa-user-edit me-2"},null,-1),gt=t("button",{type:"button",class:"close","data-dismiss":"modal"},[t("span",null,"×")],-1),yt={class:"modal-body pt-2"},kt={class:"row"},wt={class:"col-md-6"},xt={class:"form-group mb-2"},Pt=t("label",{class:"mb-1"},"Nama",-1),Mt={class:"form-group mb-2"},Ut=t("label",{class:"mb-1"},"Email",-1),Vt={class:"form-group mb-2"},Ct=t("label",{class:"mb-1"},"NIP",-1),jt={class:"form-group mb-2"},St=t("label",{class:"mb-1"},"Tanggal Lahir",-1),Nt={class:"form-group mb-2"},Tt=t("label",{class:"mb-1"},"Jenis Kelamin",-1),$t=t("option",{value:"M"},"Laki-laki",-1),Lt=t("option",{value:"F"},"Perempuan",-1),Dt=[$t,Lt],Et={class:"form-group mb-2"},qt=t("label",{class:"mb-1"},"Password",-1),Ft=["required"],Kt={class:"col-md-6"},Bt={class:"form-group mb-2"},Jt=t("label",{class:"mb-1"},"Jabatan",-1),Gt={class:"form-group mb-2"},It=t("label",{class:"mb-1"},"TMT Jabatan",-1),zt={class:"form-group mb-2"},At=t("label",{class:"mb-1"},"Unit Kerja",-1),Ht=["value"],Wt={class:"form-group mb-2"},Yt=t("label",{class:"mb-1"},"Status",-1),Ot=t("option",{value:"PNS"},"PNS",-1),Qt=t("option",{value:"PPPK"},"PPPK",-1),Rt=[Ot,Qt],Xt={class:"form-group mb-2"},Zt=t("label",{class:"mb-1"},"TMT Pangkat",-1),te={class:"text-end mt-3"},ee=["disabled"],se={key:0,class:"fas fa-spinner fa-spin me-1"},ae={key:1,class:"fas fa-save me-1"},ne={__name:"UserList",setup(oe){const p=c(!1),w=B(),f=c([]),o=c({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),v=c(""),h=c(!1),_=c(!1),a=c({}),m=async(n=1)=>{h.value=!0;try{const s=await b.get("/api/users",{params:{page:n,search:v.value}});f.value=s.data.data,o.value={...o.value,...s.data.meta,...s.data}}catch(s){console.error("Gagal memuat data pengguna:",s)}finally{h.value=!1}},L=()=>{_.value=!1,a.value={},$("#userModal").modal("show")},D=n=>{var s;_.value=!0,a.value={...n,...n.employee,id_work_unit:(s=n.employee)==null?void 0:s.id_work_unit},$("#userModal").modal("show")},E=async()=>{p.value=!0;try{_.value?await b.put(`/api/users/${a.value.id}`,a.value):await b.post("/api/users",a.value),m(),$("#userModal").modal("hide")}catch(n){alert("Gagal menyimpan data: "+n)}finally{p.value=!1}},q=async n=>{if(confirm("Yakin ingin menghapus pengguna ini?"))try{await b.delete(`/api/users/${n}`),m()}catch{alert("Gagal menghapus pengguna")}};return j(v,z(()=>m(1),400)),j(()=>a.nip,n=>{a.username=n}),J(()=>{m(),w.getWorkunitList()}),(n,s)=>(u(),d(g,null,[t("section",{class:"content-header"},[t("div",{class:"container-fluid"},[t("div",{class:"d-flex justify-content-between align-items-center"},[A,t("button",{class:"btn btn-primary btn-sm",onClick:L},"+ Tambah Pengguna")])])]),t("section",H,[t("div",W,[t("div",Y,[t("div",O,[i(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e),type:"text",class:"form-control",placeholder:"Cari nama, email, NIP, atau unit kerja..."},null,512),[[r,v.value]])]),t("div",Q,[t("table",R,[X,t("tbody",null,[h.value?(u(),d("tr",Z,et)):f.value.length===0?(u(),d("tr",st,ot)):G("",!0),(u(!0),d(g,null,S(f.value,(e,F)=>{var x,P,M,U,V,C;return u(),d("tr",{key:e.id},[t("td",null,l(F+1+(o.value.current_page-1)*o.value.per_page),1),t("td",null,[t("strong",null,l(((x=e.employee)==null?void 0:x.full_name)||e.name),1)]),t("td",null,l(((P=e.employee)==null?void 0:P.job_title)||"-"),1),t("td",null,l(((M=e.employee)==null?void 0:M.nip)||"-"),1),t("td",null,l(((V=(U=e.employee)==null?void 0:U.work_unit)==null?void 0:V.unit_name)||"-"),1),t("td",null,l(((C=e.employee)==null?void 0:C.employment_status)||"-"),1),t("td",null,[t("button",{class:"btn btn-sm btn-warning mr-1",onClick:K=>D(e)},"Edit",8,lt),t("button",{class:"btn btn-sm btn-danger",onClick:K=>q(e.id)},"Hapus",8,nt)])])}),128))])])]),t("div",it,[t("div",dt,[t("div",rt," Menampilkan "+l(o.value.from)+" - "+l(o.value.to)+" dari "+l(o.value.total)+" pengguna ",1),t("ul",ut,[t("li",{class:N(["page-item",{disabled:o.value.current_page===1}])},[t("a",{class:"page-link",href:"#",onClick:s[1]||(s[1]=y(e=>m(o.value.current_page-1),["prevent"]))},"«")],2),t("li",ct,[t("span",mt," Halaman "+l(o.value.current_page)+" / "+l(o.value.last_page),1)]),t("li",{class:N(["page-item",{disabled:o.value.current_page===o.value.last_page}])},[t("a",{class:"page-link",href:"#",onClick:s[2]||(s[2]=y(e=>m(o.value.current_page+1),["prevent"]))},"»")],2)])])])])]),t("div",_t,[t("div",pt,[t("div",vt,[t("div",bt,[t("h5",ft,[ht,T(l(_.value?"Edit Pengguna":"Tambah Pengguna"),1)]),gt]),t("div",yt,[t("form",{onSubmit:y(E,["prevent"])},[t("div",kt,[t("div",wt,[t("div",xt,[Pt,i(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>a.value.full_name=e),class:"form-control form-control-sm",required:""},null,512),[[r,a.value.full_name]])]),t("div",Mt,[Ut,i(t("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>a.value.email=e),class:"form-control form-control-sm",required:""},null,512),[[r,a.value.email]])]),t("div",Vt,[Ct,i(t("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>a.value.nip=e),class:"form-control form-control-sm",required:""},null,512),[[r,a.value.nip]])]),t("div",jt,[St,i(t("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>a.value.date_of_birth=e),type:"date",class:"form-control form-control-sm"},null,512),[[r,a.value.date_of_birth]])]),t("div",Nt,[Tt,i(t("select",{"onUpdate:modelValue":s[7]||(s[7]=e=>a.value.gender=e),class:"form-control form-control-sm"},Dt,512),[[k,a.value.gender]])]),t("div",Et,[qt,i(t("input",{"onUpdate:modelValue":s[8]||(s[8]=e=>a.value.password=e),type:"password",class:"form-control form-control-sm",required:!_.value},null,8,Ft),[[r,a.value.password]])])]),t("div",Kt,[t("div",Bt,[Jt,i(t("input",{"onUpdate:modelValue":s[9]||(s[9]=e=>a.value.job_title=e),class:"form-control form-control-sm"},null,512),[[r,a.value.job_title]])]),t("div",Gt,[It,i(t("input",{"onUpdate:modelValue":s[10]||(s[10]=e=>a.value.tmt_jabatan=e),type:"date",class:"form-control form-control-sm"},null,512),[[r,a.value.tmt_jabatan]])]),t("div",zt,[At,i(t("select",{"onUpdate:modelValue":s[11]||(s[11]=e=>a.value.id_work_unit=e),class:"form-control form-control-sm"},[(u(!0),d(g,null,S(I(w).workunitList,e=>(u(),d("option",{key:e.id,value:e.id},l(e.text),9,Ht))),128))],512),[[k,a.value.id_work_unit]])]),t("div",Wt,[Yt,i(t("select",{"onUpdate:modelValue":s[12]||(s[12]=e=>a.value.employment_status=e),class:"form-control form-control-sm"},Rt,512),[[k,a.value.employment_status]])]),t("div",Xt,[Zt,i(t("input",{"onUpdate:modelValue":s[13]||(s[13]=e=>a.value.tmt_pangkat=e),type:"date",class:"form-control form-control-sm"},null,512),[[r,a.value.tmt_pangkat]])])])]),t("div",te,[t("button",{type:"submit",class:"btn btn-sm btn-primary",disabled:p.value},[p.value?(u(),d("i",se)):(u(),d("i",ae)),T(" Simpan ")],8,ee)])],32)])])])])])],64))}};export{ne as default};
