import{n as M,u as T,g as p,r as F,y as D,c as n,a as e,s as a,l as d,t as i,i as y,j as u,v as m,B as g,F as x,z as B,b as w,d as L,o as r}from"./app-V0-BWaBe.js";import{u as W}from"./toastr-BkZmOtqG.js";import{u as E}from"./MasterDataStore-DJyB6e-k.js";import"./LoadingStore-DSiXWE7Q.js";const I={class:"content-header"},z={class:"container-fluid"},J={class:"row mb-2"},A=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"Profile")],-1),K={key:0,class:"col-sm-6"},G=e("ol",{class:"breadcrumb float-sm-right"},[e("li",{class:"breadcrumb-item"},[e("a",{href:"#"},"Home")]),e("li",{class:"breadcrumb-item active"},"Profile")],-1),H=[G],$={class:"content"},q={class:"container-fluid"},O={class:"row",style:{"margin-bottom":"100px"}},Q={class:"col-md-3"},R={class:"card card-primary card-outline"},X={class:"card-body box-profile"},Y={class:"text-center"},Z=["src"],ee={class:"profile-username text-center"},se={class:"text-muted text-center text-sm"},oe={class:"col-md-9"},te={class:"card"},le=L('<div class="card-header p-2"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" href="#profile" data-toggle="tab"><i class="fa fa-user mr-1"></i> Edit Profile</a></li><li class="nav-item"><a class="nav-link" href="#changePassword" data-toggle="tab"><i class="fa fa-key mr-1"></i> Change Password</a></li></ul></div>',1),ae={class:"card-body"},ne={class:"tab-content"},re={class:"tab-pane active",id:"profile"},ie={class:"form-group row"},ce=e("label",{class:"col-sm-2 col-form-label"},"NIP",-1),de={class:"col-sm-10"},ue={key:0,class:"text-danger text-sm"},me={class:"form-group row"},_e=e("label",{class:"col-sm-2 col-form-label"},"Full Name",-1),pe={class:"col-sm-10"},fe={key:0,class:"text-danger text-sm"},ve={class:"form-group row"},he=e("label",{class:"col-sm-2 col-form-label"},"Date of Birth",-1),be={class:"col-sm-10"},ye={key:0,class:"text-danger text-sm"},ge={class:"form-group row"},we=e("label",{class:"col-sm-2 col-form-label"},"Gender",-1),ke={class:"col-sm-10"},xe=e("option",{value:""},"Select",-1),Pe=e("option",{value:"M"},"Male",-1),Ue=e("option",{value:"F"},"Female",-1),Se=[xe,Pe,Ue],Ce={key:0,class:"text-danger text-sm"},Ve={class:"form-group row"},Ne=e("label",{class:"col-sm-2 col-form-label"},"Phone",-1),je={class:"col-sm-10"},Me={key:0,class:"text-danger text-sm"},Te={class:"form-group row"},Fe=e("label",{class:"col-sm-2 col-form-label"},"Email",-1),De={class:"col-sm-10"},Be={key:0,class:"text-danger text-sm"},Le={class:"form-group row"},We=e("label",{class:"col-sm-2 col-form-label"},"Job Title",-1),Ee={class:"col-sm-10"},Ie={key:0,class:"text-danger text-sm"},ze={class:"form-group row"},Je=e("label",{class:"col-sm-2 col-form-label"},"Work Unit",-1),Ae={class:"col-sm-10"},Ke=e("option",{value:""},"Select Work Unit",-1),Ge=["value"],He={key:0,class:"text-danger text-sm"},$e={class:"form-group row"},qe=e("label",{class:"col-sm-2 col-form-label"},"Status",-1),Oe={class:"col-sm-10"},Qe=e("option",{value:""},"Select",-1),Re=e("option",{value:"PNS"},"PNS",-1),Xe=e("option",{value:"PPPK"},"PPPK",-1),Ye=[Qe,Re,Xe],Ze={key:0,class:"text-danger text-sm"},es={class:"form-group row"},ss=e("label",{class:"col-sm-2 col-form-label"},"TMT Pangkat",-1),os={class:"col-sm-10"},ts={key:0,class:"text-danger text-sm"},ls={class:"form-group row"},as=e("label",{class:"col-sm-2 col-form-label"},"TMT Jabatan",-1),ns={class:"col-sm-10"},rs={key:0,class:"text-danger text-sm"},is={class:"form-group row"},cs={class:"offset-sm-2 col-sm-10"},ds=["disabled"],us={key:0,class:"fa fa-spinner fa-spin mr-1"},ms={key:1,class:"fa fa-save mr-1"},_s={class:"tab-pane",id:"changePassword"},ps={class:"form-group row"},fs=e("label",{for:"currentPassword",class:"col-sm-3 col-form-label"},"Current Password",-1),vs={class:"col-sm-9"},hs={key:0,class:"text-danger text-sm"},bs={class:"form-group row"},ys=e("label",{for:"newPassword",class:"col-sm-3 col-form-label"},"New Password",-1),gs={class:"col-sm-9"},ws={key:0,class:"text-danger text-sm"},ks={class:"form-group row"},xs=e("label",{for:"passwordConfirmation",class:"col-sm-3 col-form-label"},"Confirm New Password",-1),Ps={class:"col-sm-9"},Us={class:"form-group row"},Ss={class:"offset-sm-3 col-sm-9"},Cs=["disabled"],Vs={key:0,class:"fa fa-spinner fa-spin mr-1"},Ns={key:1,class:"fa fa-save mr-1"},js=e("i",{class:"fas fa-sign-out-alt"},null,-1),Ls={__name:"UserProfile",setup(Ms){const P=M(),t=T(),k=E(),f=W(),s=p([]),b=p(""),v=p(!1),h=p(!1),U=window.cloudinary.createUploadWidget({cloud_name:"kemenagpessel",upload_preset:"profile_picture_pegawai"},(c,o)=>{!c&&o&&o.event==="success"&&(b.value=o.info.secure_url),!c&&o&&o.event=="close"&&N()});function S(){U.open()}const C=()=>{v.value=!0,axios.put("/api/profile",{nip:t.user.employee.nip,full_name:t.user.employee.full_name,date_of_birth:t.user.employee.date_of_birth,gender:t.user.employee.gender,phone_number:t.user.employee.phone_number,email:t.user.employee.email,job_title:t.user.employee.job_title,id_work_unit:t.user.employee.id_work_unit,employment_status:t.user.employee.employment_status,tmt_pangkat:t.user.employee.tmt_pangkat,tmt_jabatan:t.user.employee.tmt_jabatan}).then(c=>{f.success("Profile updated successfully!")}).catch(c=>{c.response&&c.response.status===422&&(s.value=c.response.data.errors)}).finally(()=>{v.value=!1})},V=()=>{t.logout()};p(null);const N=c=>{b.value!=""?axios.post("/api/upload-profile-image",{profile_picture:b.value}).then(o=>{t.getAuthUser(),f.success("Image uploaded successfully!")}):f.error("Image failed to upload!")},_=F({currentPassword:"",password:"",passwordConfirmation:""}),j=()=>{h.value=!0,s.value="",axios.post("/api/change-user-password",_).then(c=>{f.success(c.data.message);for(const o in _)_[o]=""}).catch(c=>{c.response&&c.response.status===422&&(s.value=c.response.data.errors)}).finally(()=>{h.value=!1})};return D(()=>{k.getWorkunitList()}),(c,o)=>(r(),n(x,null,[e("div",I,[e("div",z,[e("div",J,[A,a(P).isMobile?d("",!0):(r(),n("div",K,H))])])]),e("div",$,[e("div",q,[e("div",O,[e("div",Q,[e("div",R,[e("div",X,[e("div",Y,[e("img",{onClick:S,class:"profile-user-img img-circle",src:a(t).user.avatar,alt:"User profile picture"},null,8,Z)]),e("h3",ee,i(a(t).user.employee.full_name),1),e("p",se,i(a(t).user.employee.job_title),1)])])]),e("div",oe,[e("div",te,[le,e("div",ae,[e("div",ne,[e("div",re,[e("form",{onSubmit:o[11]||(o[11]=y(l=>C(),["prevent"])),class:"form-horizontal"},[e("div",ie,[ce,e("div",de,[u(e("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>a(t).user.employee.nip=l),type:"text",class:"form-control",placeholder:"NIP"},null,512),[[m,a(t).user.employee.nip]]),s.value&&s.value.nip?(r(),n("span",ue,i(s.value.nip[0]),1)):d("",!0)])]),e("div",me,[_e,e("div",pe,[u(e("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>a(t).user.employee.full_name=l),type:"text",class:"form-control",placeholder:"Full Name"},null,512),[[m,a(t).user.employee.full_name]]),s.value&&s.value.full_name?(r(),n("span",fe,i(s.value.full_name[0]),1)):d("",!0)])]),e("div",ve,[he,e("div",be,[u(e("input",{"onUpdate:modelValue":o[2]||(o[2]=l=>a(t).user.employee.date_of_birth=l),type:"date",class:"form-control"},null,512),[[m,a(t).user.employee.date_of_birth]]),s.value&&s.value.date_of_birth?(r(),n("span",ye,i(s.value.date_of_birth[0]),1)):d("",!0)])]),e("div",ge,[we,e("div",ke,[u(e("select",{"onUpdate:modelValue":o[3]||(o[3]=l=>a(t).user.employee.gender=l),class:"form-control"},Se,512),[[g,a(t).user.employee.gender]]),s.value&&s.value.gender?(r(),n("span",Ce,i(s.value.gender[0]),1)):d("",!0)])]),e("div",Ve,[Ne,e("div",je,[u(e("input",{"onUpdate:modelValue":o[4]||(o[4]=l=>a(t).user.employee.phone_number=l),type:"text",class:"form-control",placeholder:"Phone Number"},null,512),[[m,a(t).user.employee.phone_number]]),s.value&&s.value.phone_number?(r(),n("span",Me,i(s.value.phone_number[0]),1)):d("",!0)])]),e("div",Te,[Fe,e("div",De,[u(e("input",{"onUpdate:modelValue":o[5]||(o[5]=l=>a(t).user.employee.email=l),type:"email",class:"form-control",placeholder:"Email"},null,512),[[m,a(t).user.employee.email]]),s.value&&s.value.email?(r(),n("span",Be,i(s.value.email[0]),1)):d("",!0)])]),e("div",Le,[We,e("div",Ee,[u(e("input",{"onUpdate:modelValue":o[6]||(o[6]=l=>a(t).user.employee.job_title=l),type:"text",class:"form-control",placeholder:"Job Title"},null,512),[[m,a(t).user.employee.job_title]]),s.value&&s.value.job_title?(r(),n("span",Ie,i(s.value.job_title[0]),1)):d("",!0)])]),e("div",ze,[Je,e("div",Ae,[u(e("select",{"onUpdate:modelValue":o[7]||(o[7]=l=>a(t).user.employee.id_work_unit=l),class:"form-control"},[Ke,(r(!0),n(x,null,B(a(k).workunitList,l=>(r(),n("option",{key:l.id,value:l.id},i(l.text),9,Ge))),128))],512),[[g,a(t).user.employee.id_work_unit]]),s.value&&s.value.id_work_unit?(r(),n("span",He,i(s.value.id_work_unit[0]),1)):d("",!0)])]),e("div",$e,[qe,e("div",Oe,[u(e("select",{"onUpdate:modelValue":o[8]||(o[8]=l=>a(t).user.employee.employment_status=l),class:"form-control"},Ye,512),[[g,a(t).user.employee.employment_status]]),s.value&&s.value.employment_status?(r(),n("span",Ze,i(s.value.employment_status[0]),1)):d("",!0)])]),e("div",es,[ss,e("div",os,[u(e("input",{"onUpdate:modelValue":o[9]||(o[9]=l=>a(t).user.employee.tmt_pangkat=l),type:"date",class:"form-control"},null,512),[[m,a(t).user.employee.tmt_pangkat]]),s.value&&s.value.tmt_pangkat?(r(),n("span",ts,i(s.value.tmt_pangkat[0]),1)):d("",!0)])]),e("div",ls,[as,e("div",ns,[u(e("input",{"onUpdate:modelValue":o[10]||(o[10]=l=>a(t).user.employee.tmt_jabatan=l),type:"date",class:"form-control"},null,512),[[m,a(t).user.employee.tmt_jabatan]]),s.value&&s.value.tmt_jabatan?(r(),n("span",rs,i(s.value.tmt_jabatan[0]),1)):d("",!0)])]),e("div",is,[e("div",cs,[e("button",{type:"submit",class:"btn btn-success",disabled:v.value},[v.value?(r(),n("i",us)):(r(),n("i",ms)),w(" Save Changes ")],8,ds)])])],32)]),e("div",_s,[e("form",{onSubmit:y(j,["prevent"]),class:"form-horizontal"},[e("div",ps,[fs,e("div",vs,[u(e("input",{"onUpdate:modelValue":o[12]||(o[12]=l=>_.currentPassword=l),type:"password",class:"form-control",id:"currentPassword",placeholder:"Current Password"},null,512),[[m,_.currentPassword]]),s.value&&s.value.current_password?(r(),n("span",hs,i(s.value.current_password[0]),1)):d("",!0)])]),e("div",bs,[ys,e("div",gs,[u(e("input",{"onUpdate:modelValue":o[13]||(o[13]=l=>_.password=l),type:"password",class:"form-control",id:"newPassword",placeholder:"New Password"},null,512),[[m,_.password]]),s.value&&s.value.password?(r(),n("span",ws,i(s.value.password[0]),1)):d("",!0)])]),e("div",ks,[xs,e("div",Ps,[u(e("input",{"onUpdate:modelValue":o[14]||(o[14]=l=>_.passwordConfirmation=l),type:"password",class:"form-control",id:"passwordConfirmation",placeholder:"Confirm New Password"},null,512),[[m,_.passwordConfirmation]])])]),e("div",Us,[e("div",Ss,[e("button",{type:"submit",class:"btn btn-success",disabled:h.value},[h.value?(r(),n("i",Vs)):(r(),n("i",Ns)),w(" Save Changes ")],8,Cs)])])],32)])])]),e("button",{onClick:y(V,["prevent"]),type:"button",class:"btn btn-danger btn-block"},[js,w(" Logout")])])])])])])],64))}};export{Ls as default};
