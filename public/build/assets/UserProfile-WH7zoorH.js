import{n as H,u as G,e as f,r as R,f as $,c as n,o as r,a as s,l as d,p as a,t as i,b as q,h as g,i as m,v as p,z as w,F,x as O,d as x}from"./app-DGUjp6ma.js";import{u as Q}from"./toastr-1_iMC2bi.js";import{u as X}from"./MasterDataStore-CWRgFqPn.js";import"./LoadingStore-BaWbkLMm.js";const Y={class:"content-header"},Z={class:"container-fluid"},ee={class:"row mb-2"},se={key:0,class:"col-sm-6"},oe={class:"content"},le={class:"container-fluid"},te={class:"row",style:{"margin-bottom":"100px"}},ae={class:"col-md-3"},ne={class:"card card-primary card-outline"},re={class:"card-body box-profile"},ie={class:"text-center"},de=["src"],me={class:"profile-username text-center"},ue={class:"text-muted text-center text-sm"},pe={class:"col-md-9"},ce={class:"card"},fe={class:"card-body"},be={class:"tab-content"},_e={class:"tab-pane active",id:"profile"},ve={class:"col-md-6"},ye={key:0,class:"text-danger text-sm"},ge={class:"col-md-6"},we={key:0,class:"text-danger text-sm"},xe={class:"col-md-6"},ke={key:0,class:"text-danger text-sm"},Pe={class:"col-md-6"},he={key:0,class:"text-danger text-sm"},Ue={class:"col-md-6"},Ve={key:0,class:"text-danger text-sm"},Ce={class:"col-md-6"},Se={key:0,class:"text-danger text-sm"},je={class:"col-md-6"},Ne={key:0,class:"text-danger text-sm"},Me={class:"col-md-6"},Te={key:0,class:"text-danger text-sm"},Le={class:"col-md-6"},De=["value"],Ke={key:0,class:"text-danger text-sm"},Fe={class:"col-md-6"},Ie={key:0,class:"text-danger text-sm"},Be={class:"col-md-6"},Ee={key:0,class:"text-danger text-sm"},Je={class:"col-md-6"},We={key:0,class:"text-danger text-sm"},ze={class:"col-md-6"},Ae={key:0,class:"text-danger text-sm"},He={class:"col-12"},Ge=["disabled"],Re={key:0,class:"fa fa-spinner fa-spin me-1"},$e={key:1,class:"fa fa-save me-1"},qe={class:"tab-pane",id:"changePassword"},Oe={class:"form-group row"},Qe={class:"col-sm-9"},Xe={key:0,class:"text-danger text-sm"},Ye={class:"form-group row"},Ze={class:"col-sm-9"},es={key:0,class:"text-danger text-sm"},ss={class:"form-group row"},os={class:"col-sm-9"},ls={class:"form-group row"},ts={class:"offset-sm-3 col-sm-9"},as=["disabled"],ns={key:0,class:"fa fa-spinner fa-spin mr-1"},rs={key:1,class:"fa fa-save mr-1"},cs={__name:"UserProfile",setup(is){const I=H(),o=G(),k=X(),b=Q(),t=f([]),y=f(""),_=f(!1),v=f(!1),B=window.cloudinary.createUploadWidget({cloud_name:"kemenagpessel",upload_preset:"profile_picture_pegawai"},(u,e)=>{!u&&e&&e.event==="success"&&(y.value=e.info.secure_url),!u&&e&&e.event=="close"&&z()});function E(){B.open()}const J=()=>{_.value=!0,axios.put("/api/profile",{nip:o.user.employee.nip,full_name:o.user.employee.full_name,date_of_birth:o.user.employee.date_of_birth,gender:o.user.employee.gender,phone_number:o.user.employee.phone_number,email:o.user.employee.email,job_title:o.user.employee.job_title,id_work_unit:o.user.employee.id_work_unit,employment_status:o.user.employee.employment_status,tmt_pangkat:o.user.employee.tmt_pangkat,tmt_jabatan:o.user.employee.tmt_jabatan}).then(u=>{b.success("Profile updated successfully!")}).catch(u=>{u.response&&u.response.status===422&&(t.value=u.response.data.errors)}).finally(()=>{_.value=!1})},W=()=>{o.logout()};f(null);const z=u=>{y.value!=""?axios.post("/api/upload-profile-image",{profile_picture:y.value}).then(e=>{o.getAuthUser(),b.success("Image uploaded successfully!")}):b.error("Image failed to upload!")},c=R({currentPassword:"",password:"",passwordConfirmation:""}),A=()=>{v.value=!0,t.value="",axios.post("/api/change-user-password",c).then(u=>{b.success(u.data.message);for(const e in c)c[e]=""}).catch(u=>{u.response&&u.response.status===422&&(t.value=u.response.data.errors)}).finally(()=>{v.value=!1})};return $(()=>{k.getWorkunitList()}),(u,e)=>{var P,h,U,V,C,S,j,N,M,T,L,D,K;return r(),n(F,null,[s("div",Y,[s("div",Z,[s("div",ee,[e[18]||(e[18]=s("div",{class:"col-sm-6"},[s("h1",{class:"m-0"},"Profile")],-1)),a(I).isMobile?d("",!0):(r(),n("div",se,e[17]||(e[17]=[s("ol",{class:"breadcrumb float-sm-right"},[s("li",{class:"breadcrumb-item"},[s("a",{href:"#"},"Home")]),s("li",{class:"breadcrumb-item active"},"Profile")],-1)])))])])]),s("div",oe,[s("div",le,[s("div",te,[s("div",ae,[s("div",ne,[s("div",re,[s("div",ie,[s("img",{onClick:E,class:"profile-user-img img-circle",src:a(o).user.avatar,alt:"User profile picture"},null,8,de)]),s("h3",me,i(a(o).user.employee.full_name),1),s("p",ue,i(a(o).user.employee.job_title),1)])])]),s("div",pe,[s("div",ce,[e[43]||(e[43]=q('<div class="card-header p-2"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" href="#profile" data-toggle="tab"><i class="fa fa-user mr-1"></i> Edit Profile</a></li><li class="nav-item"><a class="nav-link" href="#changePassword" data-toggle="tab"><i class="fa fa-key mr-1"></i> Change Password</a></li></ul></div>',1)),s("div",fe,[s("div",be,[s("div",_e,[s("form",{onSubmit:e[13]||(e[13]=g(l=>J(),["prevent"])),class:"row g-3"},[s("div",ve,[e[19]||(e[19]=s("label",{class:"form-label small fw-semibold mb-1"},"NIP (Nomor Induk Pegawai)",-1)),m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).user.employee.nip=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.nip]]),(P=t.value)!=null&&P.nip?(r(),n("span",ye,i(t.value.nip[0]),1)):d("",!0)]),s("div",ge,[e[20]||(e[20]=s("label",{class:"form-label small fw-semibold mb-1"},"Nama Lengkap",-1)),m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a(o).user.employee.full_name=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.full_name]]),(h=t.value)!=null&&h.full_name?(r(),n("span",we,i(t.value.full_name[0]),1)):d("",!0)]),s("div",xe,[e[21]||(e[21]=s("label",{class:"form-label small fw-semibold mb-1"},"Tanggal Lahir",-1)),m(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).user.employee.date_of_birth=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.date_of_birth]]),(U=t.value)!=null&&U.date_of_birth?(r(),n("span",ke,i(t.value.date_of_birth[0]),1)):d("",!0)]),s("div",Pe,[e[23]||(e[23]=s("label",{class:"form-label small fw-semibold mb-1"},"Jenis Kelamin",-1)),m(s("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).user.employee.gender=l),class:"form-control form-control-sm",disabled:""},e[22]||(e[22]=[s("option",{value:""},"Pilih",-1),s("option",{value:"M"},"Laki-laki",-1),s("option",{value:"F"},"Perempuan",-1)]),512),[[w,a(o).user.employee.gender]]),(V=t.value)!=null&&V.gender?(r(),n("span",he,i(t.value.gender[0]),1)):d("",!0)]),s("div",Ue,[e[24]||(e[24]=s("label",{class:"form-label small fw-semibold mb-1"},"Nomor HP",-1)),m(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a(o).user.employee.phone_number=l),type:"text",class:"form-control form-control-sm",placeholder:"08xxxx"},null,512),[[p,a(o).user.employee.phone_number]]),(C=t.value)!=null&&C.phone_number?(r(),n("span",Ve,i(t.value.phone_number[0]),1)):d("",!0)]),s("div",Ce,[e[25]||(e[25]=s("label",{class:"form-label small fw-semibold mb-1"},"Email",-1)),m(s("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a(o).user.employee.email=l),type:"email",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.email]]),(S=t.value)!=null&&S.email?(r(),n("span",Se,i(t.value.email[0]),1)):d("",!0)]),s("div",je,[e[26]||(e[26]=s("label",{class:"form-label small fw-semibold mb-1"},"Golongan / Ruang",-1)),m(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>a(o).user.employee.gol_ruang=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.gol_ruang]]),(j=t.value)!=null&&j.gol_ruang?(r(),n("span",Ne,i(t.value.gol_ruang[0]),1)):d("",!0)]),s("div",Me,[e[27]||(e[27]=s("label",{class:"form-label small fw-semibold mb-1"},"Jabatan",-1)),m(s("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>a(o).user.employee.job_title=l),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.job_title]]),(N=t.value)!=null&&N.job_title?(r(),n("span",Te,i(t.value.job_title[0]),1)):d("",!0)]),s("div",Le,[e[29]||(e[29]=s("label",{class:"form-label small fw-semibold mb-1"},"Unit Kerja",-1)),m(s("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>a(o).user.employee.id_work_unit=l),class:"form-control form-control-sm",disabled:""},[e[28]||(e[28]=s("option",{value:""},"Pilih Unit Kerja",-1)),(r(!0),n(F,null,O(a(k).workunitList,l=>(r(),n("option",{key:l.id,value:l.id},i(l.text),9,De))),128))],512),[[w,a(o).user.employee.id_work_unit]]),(M=t.value)!=null&&M.id_work_unit?(r(),n("span",Ke,i(t.value.id_work_unit[0]),1)):d("",!0)]),s("div",Fe,[e[31]||(e[31]=s("label",{class:"form-label small fw-semibold mb-1"},"Status Kepegawaian",-1)),m(s("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>a(o).user.employee.employment_status=l),class:"form-control form-control-sm",disabled:""},e[30]||(e[30]=[s("option",{value:""},"Pilih",-1),s("option",{value:"PNS"},"PNS",-1),s("option",{value:"PPPK"},"PPPK",-1)]),512),[[w,a(o).user.employee.employment_status]]),(T=t.value)!=null&&T.employment_status?(r(),n("span",Ie,i(t.value.employment_status[0]),1)):d("",!0)]),s("div",Be,[e[32]||(e[32]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Pangkat",-1)),m(s("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>a(o).user.employee.tmt_pangkat=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.tmt_pangkat]]),(L=t.value)!=null&&L.tmt_pangkat?(r(),n("span",Ee,i(t.value.tmt_pangkat[0]),1)):d("",!0)]),s("div",Je,[e[33]||(e[33]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Jabatan",-1)),m(s("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>a(o).user.employee.tmt_jabatan=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.tmt_jabatan]]),(D=t.value)!=null&&D.tmt_jabatan?(r(),n("span",We,i(t.value.tmt_jabatan[0]),1)):d("",!0)]),s("div",ze,[e[34]||(e[34]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Pensiun",-1)),m(s("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>a(o).user.employee.tmt_pensiun=l),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(o).user.employee.tmt_pensiun]]),(K=t.value)!=null&&K.tmt_pensiun?(r(),n("span",Ae,i(t.value.tmt_pensiun[0]),1)):d("",!0)]),e[37]||(e[37]=s("hr",null,null,-1)),s("div",He,[e[36]||(e[36]=s("hr",null,null,-1)),s("button",{type:"submit",class:"btn btn-success btn-sm",disabled:_.value},[_.value?(r(),n("i",Re)):(r(),n("i",$e)),e[35]||(e[35]=x(" Simpan Perubahan "))],8,Ge)])],32)]),s("div",qe,[s("form",{onSubmit:g(A,["prevent"]),class:"form-horizontal"},[s("div",Oe,[e[38]||(e[38]=s("label",{for:"currentPassword",class:"col-sm-3 col-form-label"},"Current Password",-1)),s("div",Qe,[m(s("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>c.currentPassword=l),type:"password",class:"form-control",id:"currentPassword",placeholder:"Current Password"},null,512),[[p,c.currentPassword]]),t.value&&t.value.current_password?(r(),n("span",Xe,i(t.value.current_password[0]),1)):d("",!0)])]),s("div",Ye,[e[39]||(e[39]=s("label",{for:"newPassword",class:"col-sm-3 col-form-label"},"New Password",-1)),s("div",Ze,[m(s("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>c.password=l),type:"password",class:"form-control",id:"newPassword",placeholder:"New Password"},null,512),[[p,c.password]]),t.value&&t.value.password?(r(),n("span",es,i(t.value.password[0]),1)):d("",!0)])]),s("div",ss,[e[40]||(e[40]=s("label",{for:"passwordConfirmation",class:"col-sm-3 col-form-label"},"Confirm New Password",-1)),s("div",os,[m(s("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>c.passwordConfirmation=l),type:"password",class:"form-control",id:"passwordConfirmation",placeholder:"Confirm New Password"},null,512),[[p,c.passwordConfirmation]])])]),s("div",ls,[s("div",ts,[s("button",{type:"submit",class:"btn btn-success",disabled:v.value},[v.value?(r(),n("i",ns)):(r(),n("i",rs)),e[41]||(e[41]=x(" Save Changes "))],8,as)])])],32)])])]),s("button",{onClick:g(W,["prevent"]),type:"button",class:"btn btn-danger btn-block"},e[42]||(e[42]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),x(" Logout")]))])])])])])],64)}}};export{cs as default};
