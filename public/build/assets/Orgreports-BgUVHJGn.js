import{n as C,g as v,u as $,G as N,y as j,c as t,a as e,s as a,l as r,j as f,B as k,H as F,F as c,z as u,i as z,J as H,m as T,o as s,t as l,b as x}from"./app-DKYEko9h.js";import{h as p,f as D,a as U,b as A}from"./laravel-vue-pagination.es-Ch5JEwxc.js";import"./sweetalert2.all-B-44TrQ9.js";import{u as K}from"./LoadingStore-BQPl8X7A.js";import{u as O}from"./MasterDataStore-B9FbAySm.js";const W={class:"content-header"},G={class:"container-fluid"},J={class:"row mb-2"},q=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"LCHK Satker")],-1),Q={key:0,class:"col-sm-6"},X=e("ol",{class:"breadcrumb float-sm-right"},[e("li",{class:"breadcrumb-item"},[e("a",{href:"#"},"Home")]),e("li",{class:"breadcrumb-item active"},"LCKH Satker")],-1),Z=[X],ee={class:"content"},se={class:"container-fluid"},te={class:"row"},oe={class:"col-12"},ae={class:"card"},le={class:"card-body"},ie={class:"row"},ne={class:"col-6"},de={class:"form-group"},ce=e("label",{for:"mont",style:{"font-size":"small"}},"Bulan",-1),re=["value"],_e={key:0,class:"col-6"},ue={class:"form-group"},he=e("label",{for:"organization_id",style:{"font-size":"small"}},"Satuan Kerja",-1),me=["placeholder"],ve=["value"],pe={key:1,class:"col-6"},ge={class:"form-group"},ye=e("label",{for:"organization_id",style:{"font-size":"small"}},"Satuan Kerja",-1),be=["value"],fe={key:2,class:"col-12"},ke={class:"form-group"},xe=e("label",{for:"user_id",style:{"font-size":"small"}},"Pilih Pegawai",-1),Me=["placeholder"],Se=["value"],Ye={key:3,class:"col-12"},De={class:"form-group"},we=e("label",{for:"user_id",style:{"font-size":"small"}},"Pilih Pegawai",-1),Ie=["placeholder"],Le=["value"],Pe={class:"col-6"},ze=["disabled"],Ue={key:0,class:"spinner-border spinner-border-sm mr-2",role:"status"},Be=e("span",{class:"sr-only"},"Loading...",-1),Ee=[Be],Ve={key:1},Re={class:"col-6"},Ce=["disabled"],$e={key:0,class:"spinner-border spinner-border-sm mr-2",role:"status"},Ne=e("span",{class:"sr-only"},"Loading...",-1),je=[Ne],Fe={key:1},He={key:0,class:"timeline"},Te=e("hr",null,null,-1),Ae={key:0,class:"time-label"},Ke={class:"bg-primary badge badge-primary badge-sm"},Oe={class:"timeline-item"},We={class:"time"},Ge={class:"timeline-header",style:{"font-size":"smaller","line-height":"1 !important"}},Je={class:"time"},qe={class:"timeline-body",style:{"font-size":"small","line-height":"1 !important"}},Qe=e("br",null,null,-1),Xe={style:{"font-size":"smaller"}},Ze=e("br",null,null,-1),es={style:{"text-align":"right"}},ss={style:{"font-size":"smaller",width:"100%"}},ts=["href"],os={class:"bg-primary badge badge-primary badge-sm"},as={key:1,class:"text-center"},ls={key:1,class:"card"},is={class:"card-body"},ns={class:"table-responsive overlay-wrapper",id:"example-table"},ds={key:0,class:"overlay"},cs=e("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1),rs=e("div",{class:"text-bold pt-2"},"Loading...",-1),_s=[cs,rs],us={class:"table table-bordered"},hs=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Tanggal"),e("th",{scope:"col",class:"text-center"},"#"),e("th",{scope:"col",width:"50%"},"Pekerjaan"),e("th",{scope:"col",class:"text-right"},"Volume"),e("th",{scope:"col"},"Eviden")])],-1),ms={key:0},vs=["rowspan"],ps={class:"text-center"},gs={class:"s"},ys=e("br",null,null,-1),bs={class:"text-muted m-0 p-0",style:{"font-size":"small !important"}},fs={class:"s text-center"},ks={class:"s"},xs={class:"s"},Ms=e("td",{class:"s text-center"},null,-1),Ss=e("td",{colspan:"7",class:"text-center"},"Belum ada data...",-1),Ys={key:1},Ds=e("tr",null,[e("td",{colspan:"7",class:"text-center"},"Tidak ada hasil, silahkan pilih bulan... ")],-1),ws=[Ds],Is={key:3},Ls=["src"],Rs={__name:"Orgreports",setup(Ps){const M=C(),g=v(!1),S=v(!1),_=v(!1),Y=v("Pilih Item"),B=K(),h=$(),n=O(),m=v({data:[]}),y=N("SettingStore:mySelected",v("")),E=v([{text:p().subtract(2,"months").format("MMMM  YYYY"),id:p().subtract(2,"months").format("YYYY-MM")},{text:p().subtract(1,"months").format("MMMM  YYYY"),id:p().subtract(1,"months").format("YYYY-MM")},{text:p().format("MMMM  YYYY"),id:p().format("YYYY-MM")}]),w=(I=1)=>{_.value=!0,T.get(`/api/reports?monthyear=${y.value}&page=${I}&user_id=${n.userId}`).then(i=>{console.log(i.data),m.value=i.data,_.value=!1,g.value=!0,S.value=!1,_.value=!1}).catch(i=>{console.log(i.response.data),i.response&&i.response.status===401?window.location.href="/login":console.error("Terjadi kesalahan:",i)})},V=()=>{_.value=!0,g.value=!1,S.value=!0,setTimeout(function(){_.value=!1},2e3)};return j(()=>{n.getOrgList(),h.user.role=="ADMIN"&&n.getUserListbyOrgID(h.user.org_id)}),(I,i)=>{var L,P;return s(),t(c,null,[e("div",W,[e("div",G,[e("div",J,[q,a(M).isMobile?r("",!0):(s(),t("div",Q,Z))])])]),e("div",ee,[e("div",se,[e("div",te,[e("div",oe,[e("div",ae,[e("div",le,[e("div",ie,[e("div",ne,[e("div",de,[ce,f(e("select",{"onUpdate:modelValue":i[0]||(i[0]=o=>F(y)?y.value=o:null),class:"custom-select rounded-0"},[(s(!0),t(c,null,u(E.value,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,re))),128))],512),[[k,a(y)]])])]),a(h).user.role=="SUPERADMIN"||a(h).user.role=="REVIEWER"?(s(),t("div",_e,[e("div",ue,[he,f(e("select",{"onUpdate:modelValue":i[1]||(i[1]=o=>a(n).orgId=o),class:"custom-select rounded-0",placeholder:Y.value,onChange:i[2]||(i[2]=o=>a(n).getUserList(a(n).orgId)),onSelect:i[3]||(i[3]=o=>a(n).getUserList(a(n).orgId))},[(s(!0),t(c,null,u(a(n).orgList,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,ve))),128))],40,me),[[k,a(n).orgId]])])])):(s(),t("div",pe,[e("div",ge,[ye,e("input",{type:"text",class:"form-control",disabled:"",value:a(h).user.org_name},null,8,be)])])),a(h).user.role=="SUPERADMIN"||a(h).user.role=="REVIEWER"?(s(),t("div",fe,[e("div",ke,[xe,f(e("select",{"onUpdate:modelValue":i[4]||(i[4]=o=>a(n).userId=o),class:"custom-select rounded-0",placeholder:Y.value},[(s(!0),t(c,null,u(a(n).userList,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,Se))),128))],8,Me),[[k,a(n).userId]])])])):(s(),t("div",Ye,[e("div",De,[we,f(e("select",{"onUpdate:modelValue":i[5]||(i[5]=o=>a(n).userId=o),class:"custom-select rounded-0",placeholder:Y.value},[(s(!0),t(c,null,u(a(n).userList,o=>(s(),t("option",{value:o.id,key:o.id},l(o.text),9,Le))),128))],8,Ie),[[k,a(n).userId]])])])),e("div",Pe,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:_.value,onClick:z(w,["prevent"])},[_.value?(s(),t("div",Ue,Ee)):(s(),t("span",Ve,"Preview Data"))],8,ze)]),e("div",Re,[e("button",{type:"submit",class:"btn btn-warning btn-block",disabled:_.value,onClick:z(V,["prevent"])},[_.value?(s(),t("div",$e,je)):(s(),t("span",Fe,"Preview PDF"))],8,Ce)])])])]),g.value&&a(M).isMobile?(s(),t("div",He,[Te,m.value.data.length>0?(s(!0),t(c,{key:0},u(m.value.data,(o,R)=>(s(),t(c,null,[o.works.length>0?(s(!0),t(c,{key:0},u(o.works,(d,b)=>(s(),t(c,{key:d.id},[b===0?(s(),t("div",Ae,[e("span",Ke,l(a(D)(o.date)),1)])):r("",!0),e("div",null,[e("div",Oe,[e("span",We," ["+l(d.volume)+" "+l(d.unit)+"] ",1),e("h3",Ge,[e("span",Je,l(a(D)(o.date)),1)]),e("div",qe,[x(l(d.work_name),1),Qe,e("span",Xe,l(d.work_detail),1),Ze,e("div",es,[e("span",ss,[x(" Bukti Dukung "),d.evidence_url?(s(),t("a",{key:0,target:"blank",href:d.evidence_url??"#"}," [ "+l(d.evidence)+" ]",9,ts)):(s(),t(c,{key:1},[x(" [ "+l(d.evidence)+" ] ",1)],64))])])])])])],64))),128)):(s(),t(c,{key:1},[(s(),t("div",{class:"time-label",key:o.id},[e("span",os,l(a(D)(o.date)),1)])),(s(),t("div",{key:o.id,class:"text-center"}," .: Belum ada Data :. "))],64))],64))),256)):(s(),t("div",as," .: Belum ada data :. "))])):r("",!0),g.value&&!a(M).isMobile?(s(),t("div",ls,[e("div",is,[e("div",ns,[a(B).isLoading?(s(),t("div",ds,_s)):r("",!0),e("table",us,[hs,((L=m.value.data)==null?void 0:L.length)>0?(s(),t("tbody",ms,[(s(!0),t(c,null,u(m.value.data,(o,R)=>(s(),t(c,null,[o.works.length>0?(s(!0),t(c,{key:0},u(o.works,(d,b)=>(s(),t("tr",{key:d.id},[b===0?(s(),t("td",{key:0,rowspan:o.works.length,class:"s",style:{"white-space":"pre"}},l(a(U)(o.date)),9,vs)):r("",!0),e("td",ps,l(b+1),1),e("td",gs,[x(l(d.work_name)+" ",1),ys,e("p",bs,l(d.work_detail),1)]),e("td",fs,l(d.volume)+"Â "+l(d.unit),1),e("td",ks,l(d.evidence),1)]))),128)):(s(),t("tr",{key:o.id},[e("td",xs,l(a(U)(o.date)),1),Ms,Ss]))],64))),256))])):r("",!0),((P=m.value.data)==null?void 0:P.length)===0?(s(),t("tbody",Ys,ws)):r("",!0)])])])])):r("",!0),g.value?(s(),H(a(A),{key:2,data:m.value,onPaginationChangePage:w,limit:1,keepLength:!0,style:{"margin-bottom":"100px"}},null,8,["data"])):r("",!0),S.value?(s(),t("div",Is,[e("embed",{src:`/preview-lckb/${a(y)}/${a(n).userId}`,width:"100%",height:"600",type:"application/pdf"},null,8,Ls)])):r("",!0)])])])])],64)}}};export{Rs as default};
