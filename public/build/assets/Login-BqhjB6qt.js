import{e as V,r as m,c as d,f as S,g as M,o as u,_ as T,u as R,h as C,i as w,a as e,w as _,T as x,j as U,k as h,v as D,l as P,n as L,m as q,p as B,d as k,q as j,s as A,t as z,x as I}from"./app-BjdZe6lS.js";import{u as N}from"./MasterDataStore-B_BwUfjV.js";import"./LoadingStore-BI82fvY4.js";const W={key:1,style:{"min-height":"48px"},"aria-hidden":"true"},E=V({__name:"TurnstileWidget",props:{sitekey:{type:String,required:!0},modelValue:String,disableAutoReload:{type:Boolean,default:!1},theme:{type:String,default:"light"},size:{type:String,default:"normal"}},emits:["update:modelValue","error","expired"],setup(b,{expose:c,emit:v}){const n=b,a=v,l=m(null);let o=null;const r=typeof window<"u",p=m(!1),g=()=>new Promise((s,y)=>{if(!r)return y();if(window.turnstile||document.querySelector("#cf-turnstile"))return s();const i=document.createElement("script");i.id="cf-turnstile",i.src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",i.async=!0,i.defer=!0,i.onload=()=>s(),i.onerror=()=>y(),document.head.appendChild(i)}),f=()=>{!r||!window.turnstile||!l.value||(o=window.turnstile.render(l.value,{sitekey:n.sitekey,theme:n.theme,size:n.size,callback:s=>a("update:modelValue",s),"expired-callback":()=>{a("update:modelValue",""),a("expired"),n.disableAutoReload||t()},"error-callback":()=>{a("error"),n.disableAutoReload||t()}}))},t=()=>{if(r&&window.turnstile&&o)try{window.turnstile.reset(o)}catch(s){console.warn("[TurnstileWidget] Reset failed:",s)}};return c({reset:t,execute:()=>{if(r&&window.turnstile&&o)try{window.turnstile.execute(o)}catch(s){console.warn("[TurnstileWidget] Execute failed:",s)}}}),S(()=>{p.value=!0,g().then(()=>f()).catch(()=>{a("error"),n.disableAutoReload||t()})}),M(()=>{if(r&&window.turnstile&&o)try{window.turnstile.remove(o)}catch(s){console.warn("[TurnstileWidget] Cleanup failed:",s)}}),(s,y)=>p.value?(u(),d("div",{key:0,ref_key:"containerRef",ref:l},null,512)):(u(),d("div",W))}}),G={class:"login-page"},H={key:0,class:"loading-overlay"},K={class:"login-box"},O={class:"card card-outline card-success"},F={class:"card-body login-card-body"},X={key:0,class:"alert alert-danger",role:"alert"},$={class:"input-group mb-3"},J={class:"input-group mb-3"},Q=["type"],Y={class:"input-group-append"},Z={class:"text-center row justify-content-center"},ee={class:"form-group recaptcha-container mx-auto"},te={class:"row mb-3"},se={class:"col-8"},ae={class:"icheck-primary"},oe={class:"col-4"},re=["disabled"],ne={key:0},le={key:1},ie="0x4AAAAAABg5q-5b8cUPKPGt",de={__name:"Login",setup(b){const c=R(),v=N(),n=j(),a=C({username:"",password:"",remember:!0}),l=m(!1),o=m(!1),r=m(""),p=m("");S(()=>{});const g=async()=>{var f,t;o.value=!0,r.value="";try{await I.post("/login",{...a,"cf-turnstile-response":p.value}),await c.getAuthUser(),await v.getDoctypeList(),await c.getMyDocuments(),c.isAuthenticated=!0,c.activeLayout="user",n.push("/user/dashboard")}catch(s){console.error("Login error:",s),r.value=((t=(f=s.response)==null?void 0:f.data)==null?void 0:t.message)||"Terjadi kesalahan saat login."}finally{setTimeout(()=>{o.value=!1},400)}};return(f,t)=>(u(),d("div",G,[w(x,{name:"fade"},{default:_(()=>[o.value?(u(),d("div",H,t[5]||(t[5]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memproses login...",-1)]))):A("",!0)]),_:1}),e("div",K,[t[10]||(t[10]=e("div",{class:"login-logo"},[e("img",{src:"http://res.cloudinary.com/dezj1x6xp/image/upload/v1749880420/PandanViewMandeh/LOGO_SIGARDA_FIX_rw2u1g.png",alt:"logo Ekin",width:"100%"})],-1)),e("div",O,[e("div",F,[t[8]||(t[8]=e("p",{class:"login-box-msg"},"Silakan masuk untuk memulai sesi",-1)),w(x,{name:"fade"},{default:_(()=>[r.value?(u(),d("div",X,z(r.value),1)):A("",!0)]),_:1}),e("form",{onSubmit:U(g,["prevent"]),autocomplete:"off"},[e("div",$,[h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.username=s),type:"text",class:"form-control",placeholder:"NIP Anda",required:""},null,512),[[D,a.username]]),t[6]||(t[6]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-envelope"})])],-1))]),e("div",J,[h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.password=s),type:l.value?"text":"password",class:"form-control",placeholder:"Password",required:""},null,8,Q),[[P,a.password]]),e("div",Y,[e("button",{class:"input-group-text",type:"button",onClick:t[2]||(t[2]=s=>l.value=!l.value),tabindex:"-1"},[e("i",{class:L(l.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",Z,[e("div",ee,[w(q(E),{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),sitekey:ie,theme:"light"},null,8,["modelValue"])])]),e("div",te,[e("div",se,[e("div",ae,[h(e("input",{type:"checkbox",id:"remember","onUpdate:modelValue":t[4]||(t[4]=s=>a.remember=s)},null,512),[[B,a.remember]]),t[7]||(t[7]=e("label",{for:"remember"},"Â  Remember Me",-1))])]),e("div",oe,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:o.value},[o.value?(u(),d("span",ne,"Memuat...")):(u(),d("span",le,"Sign In"))],8,re)])])],32),t[9]||(t[9]=e("p",{class:"mb-1"},[e("a",{href:"https://wa.me/6282298476941?text=Halo%2C%20saya%20ingin%20bertanya",target:"_blank"},[k("Lupa Password? "),e("br"),k(" Hubungi Admin Satker")])],-1))])])])]))}},me=T(de,[["__scopeId","data-v-f21edd1a"]]);export{me as default};
