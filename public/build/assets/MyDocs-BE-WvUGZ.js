import{_ as P,g as c,u as T,N as x,y as U,x as V,c as o,a as e,t as u,I as $,j as w,v as z,F as k,z as D,l as C,o as l,A as B,b as S,O as H,p as j,e as q}from"./app-V0-BWaBe.js";import{u as G}from"./MasterDataStore-DJyB6e-k.js";import"./LoadingStore-DSiXWE7Q.js";const i=p=>(j("data-v-38b35f8b"),p=p(),q(),p),O=i(()=>e("section",{class:"content-header"},[e("div",{class:"container-fluid"},[e("h3",{class:"text-primary"},"ðŸ“‚ Daftar Dokumen")])],-1)),Q={class:"content"},R={class:"container-fluid"},J={class:"mb-3"},K={class:"d-block mb-1 text-muted font-weight-bold"},W={class:"progress",style:{height:"20px"}},X=["aria-valuenow"],Y={class:"card shadow-sm rounded-lg"},Z={class:"card-body p-3"},ee={class:"input-group mb-3"},se={key:0,class:"text-center p-5"},te=i(()=>e("div",{class:"spinner-border text-primary mb-2",role:"status"},[e("span",{class:"sr-only"},"Loading...")],-1)),ae=i(()=>e("div",{class:"text-muted"},"Memuat daftar dokumen...",-1)),oe=[te,ae],le={key:1,class:"tree"},ne={class:"list-unstyled mb-0"},re=["onClick"],ie={class:"ml-2 font-weight-bold"},de={class:"badge badge-pill badge-primary ml-2"},ce={class:"pl-4 mt-1"},ue=["onClick"],_e=i(()=>e("i",{class:"fas fa-file-pdf text-danger mr-2"},null,-1)),me={key:0,class:"text-muted small ml-4 mt-1"},pe={key:2,class:"text-center p-5"},he=i(()=>e("span",{class:"text-muted"},"Data tidak ditemukan.",-1)),ve=[he],fe={key:0,class:"modal fade show",style:{display:"block"},tabindex:"-1","aria-modal":"true"},ge={class:"modal-dialog modal-xl"},ke={class:"modal-content"},ye={class:"modal-header p-2"},be=i(()=>e("h5",{class:"modal-title"},"Preview Dokumen",-1)),xe=i(()=>e("span",null,"Ã—",-1)),we=[xe],De={class:"modal-body p-2"},Ce=["src"],Se={key:1,class:"text-muted text-center py-5"},Le={key:0},Me={key:1},Ee={__name:"MyDocs",setup(p){const L=c(null),n=c(!1),v=c([]),d=c(null),_=c(""),f=c(!1),M=()=>{n.value=!1},E=()=>{n.value=!0},y=G(),m=T(),h=x(()=>{var a,t;return((t=(a=m.user)==null?void 0:a.employee)==null?void 0:t.progress_dokumen)??0}),F=async()=>{console.log("eh kepanggil fetchdata didalam Doclist"),await y.getDoctypeList(),await m.getMyDocuments();const a=y.doctypeList,t=m.myDocuments;v.value=a.map(s=>{const g=t.filter(r=>(r.id_doc_type===s.id||r.doc_type_id===s.id||r.doc_type===s.id)&&r.status==="Approved");return{id:s.id,text:s.text,expanded:!0,files:g}})},I=a=>{a.expanded=!a.expanded},A=async a=>{var t;n.value=!1,d.value=a;try{const s=await fetch(a,{method:"HEAD"});(!s.ok||!((t=s.headers.get("content-type"))!=null&&t.includes("pdf")))&&(n.value=!0)}catch{n.value=!0}},N=()=>{_.value=""},b=x(()=>{if(!_.value)return v.value;const a=_.value.toLowerCase();return v.value.filter(t=>t.text.toLowerCase().includes(a)||t.files.some(s=>s.file_name.toLowerCase().includes(a)))});return U(async()=>{var a,t;f.value=!0,await m.getDocsUpdateState(),console.log("Progress Dokumen:",(t=(a=m.user)==null?void 0:a.employee)==null?void 0:t.progress_dokumen),console.log("eh kepanggil fetchdata didalam onMounted Doclist"),await F(),f.value=!1}),V(()=>d,async a=>{var t;if(n.value=!1,!!a)try{const s=await fetch(a,{method:"HEAD"});(!s.ok||!((t=s.headers.get("content-type"))!=null&&t.includes("pdf")))&&(n.value=!0)}catch{n.value=!0}}),(a,t)=>(l(),o(k,null,[O,e("section",Q,[e("div",R,[e("div",J,[e("label",K," Progress Dokumen: "+u(h.value||0)+"% ",1),e("div",W,[e("div",{class:"progress-bar bg-success",style:$({width:h.value+"%"}),role:"progressbar","aria-valuenow":h.value,"aria-valuemin":"0","aria-valuemax":"100"},u(h.value||0)+"% ",13,X)])]),e("div",Y,[e("div",Z,[e("div",ee,[w(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),class:"form-control",placeholder:"Cari dokumen..."},null,512),[[z,_.value]]),e("div",{class:"input-group-append"},[e("button",{class:"btn btn-outline-secondary",type:"button",onClick:N},"Reset")])]),f.value?(l(),o("div",se,oe)):b.value.length?(l(),o("div",le,[e("ul",ne,[(l(!0),o(k,null,D(b.value,(s,g)=>(l(),o("li",{key:s.id,class:"mb-2"},[e("div",{onClick:r=>I(s),class:"d-flex align-items-center cursor-pointer py-1 px-2 bg-light rounded small"},[e("i",{class:B([s.expanded?"fas fa-folder-open text-warning":"fas fa-folder text-secondary","mr-2"])},null,2),e("span",ie,[S(u(g+1)+". "+u(s.text)+" ",1),e("span",de,u(s.files.length),1)])],8,re),w(e("ul",ce,[(l(!0),o(k,null,D(s.files,r=>(l(),o("li",{key:r.id,onClick:Fe=>A(r.file_url),class:"cursor-pointer p-1 rounded hover-bg-light small"},[_e,S(" "+u(r.file_name),1)],8,ue))),128)),s.files.length?C("",!0):(l(),o("li",me," Tidak ada file diupload. "))],512),[[H,s.expanded]])]))),128))])])):(l(),o("div",pe,ve))])])])]),d.value?(l(),o("div",fe,[e("div",ge,[e("div",ke,[e("div",ye,[be,e("button",{type:"button",class:"close",onClick:t[1]||(t[1]=s=>d.value=null)},we)]),e("div",De,[d.value&&!n.value?(l(),o("iframe",{key:0,ref_key:"pdfFrame",ref:L,src:`${d.value}#toolbar=0&navpanes=0&scrollbar=0`,class:"w-100",frameborder:"0",style:{height:"90vh",border:"1px solid #ccc"},onLoad:M,onError:E},null,40,Ce)):(l(),o("div",Se,[n.value?(l(),o("p",Le,"Gagal memuat dokumen. Pastikan file tersedia dan dapat diakses. ")):(l(),o("p",Me,"File tidak tersedia."))]))])])])])):C("",!0)],64))}},Pe=P(Ee,[["__scopeId","data-v-38b35f8b"]]);export{Pe as default};
