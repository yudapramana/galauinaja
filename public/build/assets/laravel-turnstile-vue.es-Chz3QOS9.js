import{B as g,e as s,c,f as k,g as x,o as p}from"./app-KrrOjlBx.js";const v={key:1,style:{"min-height":"48px"},"aria-hidden":"true"},R=g({__name:"TurnstileWidget",props:{sitekey:{type:String,required:!0},modelValue:String,disableAutoReload:{type:Boolean,default:!1},theme:{type:String,default:"light"},size:{type:String,default:"normal"}},emits:["update:modelValue","error","expired"],setup(f,{expose:m,emit:w}){const l=f,n=w,a=s(null);let t=null;const i=typeof window<"u",d=s(!1),h=()=>new Promise((e,u)=>{if(!i)return u();if(window.turnstile||document.querySelector("#cf-turnstile"))return e();const r=document.createElement("script");r.id="cf-turnstile",r.src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",r.async=!0,r.defer=!0,r.onload=()=>e(),r.onerror=()=>u(),document.head.appendChild(r)}),y=()=>{!i||!window.turnstile||!a.value||(t=window.turnstile.render(a.value,{sitekey:l.sitekey,theme:l.theme,size:l.size,callback:e=>n("update:modelValue",e),"expired-callback":()=>{n("update:modelValue",""),n("expired"),l.disableAutoReload||o()},"error-callback":()=>{n("error"),l.disableAutoReload||o()}}))},o=()=>{if(i&&window.turnstile&&t)try{window.turnstile.reset(t)}catch(e){console.warn("[TurnstileWidget] Reset failed:",e)}};return m({reset:o,execute:()=>{if(i&&window.turnstile&&t)try{window.turnstile.execute(t)}catch(e){console.warn("[TurnstileWidget] Execute failed:",e)}}}),k(()=>{d.value=!0,h().then(()=>y()).catch(()=>{n("error"),l.disableAutoReload||o()})}),x(()=>{if(i&&window.turnstile&&t)try{window.turnstile.remove(t)}catch(e){console.warn("[TurnstileWidget] Cleanup failed:",e)}}),(e,u)=>d.value?(p(),c("div",{key:0,ref_key:"containerRef",ref:a},null,512)):(p(),c("div",v))}});export{R};
