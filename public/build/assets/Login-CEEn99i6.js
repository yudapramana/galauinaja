import{_ as k,u as x,r as A,e as c,f as S,c as r,o as n,g as p,a as e,w as m,T as g,h as M,i as u,v,j as T,d as f,k as C,l as b,t as D,m as P}from"./app-DGUjp6ma.js";import{u as V}from"./MasterDataStore-CWRgFqPn.js";import"./LoadingStore-BaWbkLMm.js";const I={class:"login-page"},L={key:0,class:"loading-overlay"},U={class:"login-box"},E={class:"card card-outline card-success"},N={class:"card-body login-card-body"},H={key:0,class:"alert alert-danger",role:"alert"},K={class:"input-group mb-3"},R={class:"input-group mb-3"},z={class:"row"},B={class:"col-8"},j={class:"icheck-primary"},q={class:"col-4"},G=["disabled"],Y={key:0},F={key:1},J={__name:"Login",setup(O){const i=x(),w=V(),_=C(),a=A({username:"",password:"",remember:!0}),o=c(!1),l=c(""),y=window.RECAPTCHA_SITE_KEY;S(()=>{window.grecaptcha||console.error("reCAPTCHA not loaded")});const h=async()=>{var d,s;o.value=!0,l.value="";try{if(!window.grecaptcha)throw new Error("reCAPTCHA not loaded");const t=await window.grecaptcha.execute(y,{action:"login"});await P.post("/login",{...a,recaptcha_token:t}),await i.getAuthUser(),await w.getDoctypeList(),await i.getMyDocuments(),i.isAuthenticated=!0,i.activeLayout="user",_.push("/user/dashboard")}catch(t){console.error("Login error:",t),l.value=((s=(d=t.response)==null?void 0:d.data)==null?void 0:s.message)||"Terjadi kesalahan saat login."}finally{setTimeout(()=>{o.value=!1},400)}};return(d,s)=>(n(),r("div",I,[p(g,{name:"fade"},{default:m(()=>[o.value?(n(),r("div",L,s[3]||(s[3]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memproses login...",-1)]))):b("",!0)]),_:1}),e("div",U,[s[9]||(s[9]=e("div",{class:"login-logo text-center mb-4"},[e("h1",{class:"mb-1",style:{"font-size":"1.75rem","font-weight":"700",color:"#28a745"}},"SIGARDA"),e("p",{class:"mb-0",style:{"font-size":"0.95rem","font-weight":"500"}},"Sistem Informasi Gerbang Arsip Digital Pegawai"),e("p",{style:{"font-size":"0.85rem",color:"#6c757d"}},"Kementerian Agama Kab. Pesisir Selatan")],-1)),e("div",E,[e("div",N,[s[7]||(s[7]=e("p",{class:"login-box-msg"},"Silakan masuk untuk memulai sesi",-1)),p(g,{name:"fade"},{default:m(()=>[l.value?(n(),r("div",H,D(l.value),1)):b("",!0)]),_:1}),e("form",{onSubmit:M(h,["prevent"]),autocomplete:"off"},[e("div",K,[u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>a.username=t),type:"text",class:"form-control",placeholder:"NIP Anda",required:""},null,512),[[v,a.username]]),s[4]||(s[4]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-envelope"})])],-1))]),e("div",R,[u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.password=t),type:"password",class:"form-control",placeholder:"Password",required:""},null,512),[[v,a.password]]),s[5]||(s[5]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-lock"})])],-1))]),e("div",z,[e("div",B,[e("div",j,[u(e("input",{type:"checkbox",id:"remember","onUpdate:modelValue":s[2]||(s[2]=t=>a.remember=t)},null,512),[[T,a.remember]]),s[6]||(s[6]=e("label",{for:"remember"},"Â  Remember Me",-1))])]),e("div",q,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:o.value},[o.value?(n(),r("span",Y,"Memuat...")):(n(),r("span",F,"Sign In"))],8,G)])])],32),s[8]||(s[8]=e("p",{class:"mb-1"},[e("a",{href:"#"},[f("Lupa Password? "),e("br"),f(" Hubungi Admin Satker")])],-1))])])])]))}},Z=k(J,[["__scopeId","data-v-6800aa59"]]);export{Z as default};
