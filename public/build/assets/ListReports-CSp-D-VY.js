import{n as U,u as R,g as B,G as A,y as E,q as K,c as e,a as t,s as l,l as _,h as M,w,j as F,B as I,H as O,F as c,z as v,I as q,m as L,o as s,t as i,b as u,i as k}from"./app-ClEBpTSD.js";import{h as r,f as $,a as z,b as G}from"./laravel-vue-pagination.es-Fin6ChvM.js";import{S as C}from"./sweetalert2.all-DWkFJy1E.js";import{u as W}from"./LoadingStore-DaenCWHc.js";const J={class:"content-header"},Q={class:"container-fluid"},X={class:"row mb-2"},Z=t("div",{class:"col-sm-6"},[t("h1",{class:"m-0"},"Laporan Kerja")],-1),tt={key:0,class:"col-sm-6"},et=t("ol",{class:"breadcrumb float-sm-right"},[t("li",{class:"breadcrumb-item"},[t("a",{href:"#"},"Home")]),t("li",{class:"breadcrumb-item active"},"Laporan Kerja")],-1),st=[et],at={class:"content"},ot={class:"container-fluid"},nt={class:"row"},it={class:"col-lg-12"},lt={class:"d-flex justify-content-between mb-2"},dt={key:0},ct=t("button",{class:"btn btn-primary"},[t("i",{class:"fa fa-plus-circle mr-1"}),u(" Tambah ")],-1),rt={class:"btn-group"},_t=t("span",{class:"mr-1"},"Print",-1),ht=[_t],ut=["value"],mt=t("hr",null,null,-1),ft={key:0,class:"text-center"},pt=t("div",{class:"overlay"},[t("i",{class:"fas fa-3x fa-sync-alt fa-spin"}),t("div",{class:"text-bold pt-2"},"Loading...")],-1),bt=[pt],vt={key:0,class:"time-label"},gt={class:"bg-primary badge badge-primary badge-sm"},yt={style:{"margin-bottom":"10px"}},xt={class:"timeline-item"},Yt={class:"time"},Mt=["onClick"],kt={class:"timeline-header",style:{"font-size":"smaller","line-height":"1 !important"}},Ct={class:"time"},St={class:"timeline-body",style:{"font-size":"small","line-height":"1 !important"}},Bt=t("br",null,null,-1),wt={style:{"font-size":"smaller"}},Lt=t("br",null,null,-1),$t={style:{"text-align":"right"}},Dt={style:{"font-size":"smaller",width:"100%"}},Tt=["href"],zt={class:"bg-primary badge badge-primary badge-sm"},Ht=["onClick"],jt={key:2,class:"text-center"},Nt={key:1,class:"card"},Pt={class:"card-body"},Vt={class:"table-responsive overlay-wrapper"},Ut={key:0,class:"overlay"},Rt=t("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1),At=t("div",{class:"text-bold pt-2"},"Loading...",-1),Et=[Rt,At],Kt={class:"table table-bordered",style:{"line-height":"1 !important"}},Ft=t("thead",null,[t("tr",null,[t("th",{scope:"col text-sm"},"Tanggal"),t("th",{scope:"col text-sm",class:"text-center"},"#"),t("th",{scope:"col text-sm",width:"50%"},"Pekerjaan"),t("th",{scope:"col text-sm",class:"text-right"},"Vol"),t("th",{scope:"col text-sm"},"Unit"),t("th",{scope:"col text-sm"},"Eviden"),t("th",{scope:"col text-sm"},"Options")])],-1),It={key:0},Ot=["rowspan"],qt={class:"text-center text-sm"},Gt={class:"s text-sm"},Wt=t("br",null,null,-1),Jt=["innerHTML"],Qt={class:"s text-right text-sm"},Xt={class:"s text-sm"},Zt={class:"s text-sm"},te=["href"],ee={class:"text-center"},se=t("i",{class:"fa fa-edit"},null,-1),ae=["onClick"],oe=t("i",{class:"fa fa-trash text-danger ml-2"},null,-1),ne=[oe],ie={class:"s text-sm",style:{"white-space":"pre"}},le={class:"s text-center text-sm"},de=["onClick"],ce=t("i",{class:"fa fa-trash text-danger"},null,-1),re=[ce],_e=t("td",{colspan:"7",class:"text-center text-sm"},"Belum ada data...",-1),he={key:1},ue=t("tr",null,[t("td",{colspan:"7",class:"text-center"},"Tidak ada hasil, silahkan pilih bulan... ")],-1),me=[ue],ye={__name:"ListReports",setup(fe){const g=U(),y=W(),H=R(),d=B({data:[]}),S=(f=1)=>{y.toggleLoading(),L.get(`/api/reports?monthyear=${m.value}&page=${f}`).then(n=>{d.value=n.data,y.toggleLoading()}).catch(n=>{n.response&&n.response.status===401?window.location.href="/login":console.error("Terjadi kesalahan:",n)})},D=(f,n)=>{C.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(h=>{h.isConfirmed&&L.delete(`/api/reports/${n}`).then(x=>{d.value.data[f].works=d.value.data[f].works.filter(p=>p.id!==n),C.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})})})},T=(f,n)=>{C.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(h=>{h.isConfirmed&&L.delete(`/api/parent-reports/${n}`).then(x=>{d.value.data=d.value.data.filter(p=>p.id!==n),C.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})})})},m=A("SettingStore:mySelected",B("")),j=B([{text:r().subtract(5,"months").format("MMMM  YYYY"),id:r().subtract(5,"months").format("YYYY-MM")},{text:r().subtract(4,"months").format("MMMM  YYYY"),id:r().subtract(4,"months").format("YYYY-MM")},{text:r().subtract(3,"months").format("MMMM  YYYY"),id:r().subtract(3,"months").format("YYYY-MM")},{text:r().subtract(2,"months").format("MMMM  YYYY"),id:r().subtract(2,"months").format("YYYY-MM")},{text:r().subtract(1,"months").format("MMMM  YYYY"),id:r().subtract(1,"months").format("YYYY-MM")},{text:r().format("MMMM  YYYY"),id:r().format("YYYY-MM")}]),N=()=>{S()},P=()=>{H.user.nama_pemeriksa?m.value?window.open("/print-lckb/"+m.value,"_blank"):alert("Pilih bulan dan tahun terlebih dahulu!"):alert("Nama dan NIP pemeriksa belum diisi!. Harap diisi di profil!")};return E(()=>{S()}),(f,n)=>{var x,p;const h=K("router-link");return s(),e(c,null,[t("div",J,[t("div",Q,[t("div",X,[Z,l(g).isMobile?_("",!0):(s(),e("div",tt,st))])])]),t("div",at,[t("div",ot,[t("div",nt,[t("div",it,[t("div",lt,[l(g).isMobile?_("",!0):(s(),e("div",dt,[M(h,{to:"/admin/reports/create"},{default:w(()=>[ct]),_:1})])),t("div",rt,[t("button",{onClick:n[0]||(n[0]=o=>P()),class:"btn btn-secondary"},ht),F(t("select",{"onUpdate:modelValue":n[1]||(n[1]=o=>O(m)?m.value=o:null),class:"custom-select rounded-0",onChange:n[2]||(n[2]=o=>N())},[(s(!0),e(c,null,v(j.value,o=>(s(),e("option",{value:o.id,key:o.id},i(o.text),9,ut))),128))],544),[[I,l(m)]])])]),l(g).isMobile?(s(),e("div",{key:0,class:"timeline",style:q(d.value.last_page==1?"margin-bottom: 100px":"")},[mt,l(y).isLoading?(s(),e("div",ft,bt)):_("",!0),d.value.data.length>0?(s(!0),e(c,{key:1},v(d.value.data,(o,b)=>(s(),e(c,null,[o.works.length>0?(s(!0),e(c,{key:0},v(o.works,(a,Y)=>(s(),e(c,{key:a.id},[Y===0?(s(),e("div",vt,[t("span",gt,i(l($)(o.date)),1)])):_("",!0),t("div",yt,[t("div",xt,[t("span",Yt,[M(h,{to:`/admin/reports/${a.id}/edit`,class:"badge badge-info right",style:{"margin-right":"3px"}},{default:w(()=>[u(" Ubah ")]),_:2},1032,["to"]),t("a",{href:"#",class:"badge badge-danger right",onClick:k(V=>D(b,a.id),["prevent"])}," Hapus ",8,Mt)]),t("h3",kt,[t("span",Ct,i(l($)(o.date)),1)]),t("div",St,[u(" ["+i(a.volume)+" "+i(a.unit)+"] "+i(a.work_name),1),Bt,t("span",wt,i(a.work_detail),1),Lt,t("div",$t,[t("span",Dt,[u(" Bukti Dukung "),a.evidence_url?(s(),e("a",{key:0,target:"blank",href:a.evidence_url??"#"}," [ "+i(a.evidence)+" ]",9,Tt)):(s(),e(c,{key:1},[u(" [ "+i(a.evidence)+" ] ",1)],64))])])])])])],64))),128)):(s(),e(c,{key:1},[(s(),e("div",{class:"time-label",key:o.id},[t("span",zt,i(l($)(o.date)),1),t("a",{class:"badge badge-danger",style:{"margin-left":"3px"},href:"#",onClick:k(a=>T(b,o.id),["prevent"])}," hapus ",8,Ht)])),(s(),e("div",{key:o.id}," .: Belum ada Data :. "))],64))],64))),256)):(s(),e("div",jt," .: Belum ada Data :. "))],4)):_("",!0),l(g).isMobile?_("",!0):(s(),e("div",Nt,[t("div",Pt,[t("div",Vt,[l(y).isLoading?(s(),e("div",Ut,Et)):_("",!0),t("table",Kt,[Ft,((x=d.value.data)==null?void 0:x.length)>0?(s(),e("tbody",It,[(s(!0),e(c,null,v(d.value.data,(o,b)=>(s(),e(c,null,[o.works.length>0?(s(!0),e(c,{key:0},v(o.works,(a,Y)=>(s(),e("tr",{key:a.id},[Y===0?(s(),e("td",{key:0,rowspan:o.works.length,class:"s text-sm",style:{"white-space":"pre"}},i(l(z)(o.date)),9,Ot)):_("",!0),t("td",qt,i(Y+1),1),t("td",Gt,[u(i(a.work_name)+" ",1),Wt,t("p",{class:"text-muted m-0 p-0",style:{"font-size":"smaller !important"},innerHTML:a.work_detail},null,8,Jt)]),t("td",Qt,i(a.volume),1),t("td",Xt,i(a.unit),1),t("td",Zt,[a.evidence_url?(s(),e("a",{key:0,target:"blank",href:a.evidence_url??"#"},i(a.evidence),9,te)):(s(),e(c,{key:1},[u(i(a.evidence),1)],64))]),t("td",ee,[M(h,{to:`/admin/reports/${a.id}/edit`},{default:w(()=>[se]),_:2},1032,["to"]),t("a",{href:"#",onClick:k(V=>D(b,a.id),["prevent"])},ne,8,ae)])]))),128)):(s(),e("tr",{key:o.id},[t("td",ie,i(l(z)(o.date)),1),t("td",le,[t("a",{href:"#",onClick:k(a=>T(b,o.id),["prevent"])},re,8,de)]),_e]))],64))),256))])):_("",!0),((p=d.value.data)==null?void 0:p.length)===0?(s(),e("tbody",he,me)):_("",!0)])])])])),M(l(G),{data:d.value,onPaginationChangePage:S,limit:1,keepLength:!0,style:{"margin-bottom":"100px"}},null,8,["data"])])])])])],64)}}};export{ye as default};
