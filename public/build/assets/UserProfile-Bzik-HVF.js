import{y as $,u as q,A as O,r as f,h as Q,f as X,c as n,o as r,a as s,s as d,m as a,t as i,b as B,j as x,k as m,v as p,E as y,F,D as Y,d as k}from"./app-DAaZhZ-B.js";import{u as Z}from"./toastr-BodhHi4d.js";import{u as ee}from"./MasterDataStore-DltuV9yV.js";import"./LoadingStore-BGNRzDtm.js";const se={class:"content-header"},te={class:"container-fluid"},oe={class:"row mb-2"},le={key:0,class:"col-sm-6"},ae={class:"content"},ne={class:"container-fluid"},re={class:"row",style:{"margin-bottom":"100px"}},ie={class:"col-md-3"},de={class:"card card-primary card-outline"},me={class:"card-body box-profile"},ue={class:"text-center"},pe=["src"],ce={class:"profile-username text-center"},fe={class:"text-muted text-center text-sm"},be={class:"col-md-9"},ve={class:"card"},_e={class:"card-body"},ye={class:"tab-content"},ge={class:"tab-pane active",id:"profile"},we={class:"col-md-6"},xe={key:0,class:"text-danger text-sm"},ke={class:"col-md-6"},Pe={key:0,class:"text-danger text-sm"},he={class:"col-md-6"},Se={key:0,class:"text-danger text-sm"},Ue={class:"col-md-6"},Ve={key:0,class:"text-danger text-sm"},je={class:"col-md-6"},Ke={key:0,class:"text-danger text-sm"},Ce={class:"col-md-6"},Te={key:0,class:"text-danger text-sm"},Me={class:"col-md-6"},De={key:0,class:"text-danger text-sm"},Ne={class:"col-md-6"},Ee={key:0,class:"text-danger text-sm"},Ie={class:"col-md-6"},Le=["value"],Be={key:0,class:"text-danger text-sm"},Fe={class:"col-md-6"},Ae={key:0,class:"text-danger text-sm"},Je={class:"col-md-6"},Re={key:0,class:"text-danger text-sm"},We={class:"col-md-6"},He={key:0,class:"text-danger text-sm"},ze={class:"col-md-6"},Ge={key:0,class:"text-danger text-sm"},$e={class:"col-md-6"},qe={key:0,class:"text-danger text-sm"},Oe={class:"col-12"},Qe=["disabled"],Xe={key:0,class:"fa fa-spinner fa-spin me-1"},Ye={key:1,class:"fa fa-save me-1"},Ze={key:1,type:"button",class:"btn btn-warning btn-sm",disabled:""},es={class:"tab-pane",id:"changePassword"},ss={class:"form-group row"},ts={class:"col-sm-9"},os={key:0,class:"text-danger text-sm"},ls={class:"form-group row"},as={class:"col-sm-9"},ns={key:0,class:"text-danger text-sm"},rs={class:"form-group row"},is={class:"col-sm-9"},ds={class:"form-group row"},ms={class:"offset-sm-3 col-sm-9"},us=["disabled"],ps={key:0,class:"fa fa-spinner fa-spin mr-1"},cs={key:1,class:"fa fa-save mr-1"},gs={__name:"UserProfile",setup(fs){const A=$(),t=q(),P=ee(),g=O();g.setting.maintenance=["1",1,!0,"true","on"].includes(g.setting.maintenance);const b=Z(),l=f([]),w=f(""),v=f(!1),_=f(!1),J=window.cloudinary.createUploadWidget({cloud_name:"pesselkemenag",upload_preset:"profile_picture"},(u,e)=>{!u&&e&&e.event==="success"&&(w.value=e.info.secure_url),!u&&e&&e.event=="close"&&z()});function R(){J.open()}const W=()=>{v.value=!0,axios.put("/api/profile",{nip:t.user.employee.nip,full_name:t.user.employee.full_name,date_of_birth:t.user.employee.date_of_birth,gender:t.user.employee.gender,phone_number:t.user.employee.phone_number,email:t.user.employee.email,job_title:t.user.employee.job_title,id_work_unit:t.user.employee.id_work_unit,employment_status:t.user.employee.employment_status,tmt_pangkat:t.user.employee.tmt_pangkat,tmt_jabatan:t.user.employee.tmt_jabatan}).then(u=>{b.success("Profile updated successfully!")}).catch(u=>{u.response&&u.response.status===422&&(l.value=u.response.data.errors)}).finally(()=>{v.value=!1})},H=()=>{t.logout()};f(null);const z=u=>{w.value!=""?axios.post("/api/upload-profile-image",{profile_picture:w.value}).then(e=>{t.getAuthUser(),b.success("Image uploaded successfully!")}):b.error("Image failed to upload!")},c=Q({currentPassword:"",password:"",passwordConfirmation:""}),G=()=>{_.value=!0,l.value="",axios.post("/api/change-user-password",c).then(u=>{b.success(u.data.message);for(const e in c)c[e]=""}).catch(u=>{u.response&&u.response.status===422&&(l.value=u.response.data.errors)}).finally(()=>{_.value=!1})};return X(()=>{P.getWorkunitList()}),(u,e)=>{var h,S,U,V,j,K,C,T,M,D,N,E,I,L;return r(),n(F,null,[s("div",se,[s("div",te,[s("div",oe,[e[19]||(e[19]=s("div",{class:"col-sm-6"},[s("h1",{class:"m-0"},"Profile")],-1)),a(A).isMobile?d("",!0):(r(),n("div",le,e[18]||(e[18]=[s("ol",{class:"breadcrumb float-sm-right"},[s("li",{class:"breadcrumb-item"},[s("a",{href:"#"},"Home")]),s("li",{class:"breadcrumb-item active"},"Profile")],-1)])))])])]),s("div",ae,[s("div",ne,[s("div",re,[s("div",ie,[s("div",de,[s("div",me,[s("div",ue,[s("img",{onClick:R,class:"profile-user-img img-circle",src:a(t).user.avatar,alt:"User profile picture"},null,8,pe)]),s("h3",ce,i(a(t).user.employee.full_name),1),s("p",fe,i(a(t).user.employee.job_title),1)])])]),s("div",be,[s("div",ve,[e[46]||(e[46]=B('<div class="card-header p-2"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" href="#profile" data-toggle="tab"><i class="fa fa-user mr-1"></i> Edit Profile</a></li><li class="nav-item"><a class="nav-link" href="#changePassword" data-toggle="tab"><i class="fa fa-key mr-1"></i> Change Password</a></li></ul></div>',1)),s("div",_e,[s("div",ye,[s("div",ge,[s("form",{onSubmit:e[14]||(e[14]=x(o=>W(),["prevent"])),class:"row g-3"},[s("div",we,[e[20]||(e[20]=s("label",{class:"form-label small fw-semibold mb-1"},"NIP (Nomor Induk Pegawai)",-1)),m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).user.employee.nip=o),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.nip]]),(h=l.value)!=null&&h.nip?(r(),n("span",xe,i(l.value.nip[0]),1)):d("",!0)]),s("div",ke,[e[21]||(e[21]=s("label",{class:"form-label small fw-semibold mb-1"},"Nama Lengkap",-1)),m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).user.employee.full_name=o),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.full_name]]),(S=l.value)!=null&&S.full_name?(r(),n("span",Pe,i(l.value.full_name[0]),1)):d("",!0)]),s("div",he,[e[22]||(e[22]=s("label",{class:"form-label small fw-semibold mb-1"},"Tanggal Lahir",-1)),m(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).user.employee.date_of_birth=o),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.date_of_birth]]),(U=l.value)!=null&&U.date_of_birth?(r(),n("span",Se,i(l.value.date_of_birth[0]),1)):d("",!0)]),s("div",Ue,[e[24]||(e[24]=s("label",{class:"form-label small fw-semibold mb-1"},"Jenis Kelamin",-1)),m(s("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).user.employee.gender=o),class:"form-control form-control-sm",disabled:""},e[23]||(e[23]=[s("option",{value:""},"Pilih",-1),s("option",{value:"M"},"Laki-laki",-1),s("option",{value:"F"},"Perempuan",-1)]),512),[[y,a(t).user.employee.gender]]),(V=l.value)!=null&&V.gender?(r(),n("span",Ve,i(l.value.gender[0]),1)):d("",!0)]),s("div",je,[e[25]||(e[25]=s("label",{class:"form-label small fw-semibold mb-1"},"Nomor HP",-1)),m(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).user.employee.phone_number=o),type:"text",class:"form-control form-control-sm",placeholder:"08xxxx"},null,512),[[p,a(t).user.employee.phone_number]]),(j=l.value)!=null&&j.phone_number?(r(),n("span",Ke,i(l.value.phone_number[0]),1)):d("",!0)]),s("div",Ce,[e[26]||(e[26]=s("label",{class:"form-label small fw-semibold mb-1"},"Email",-1)),m(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).user.employee.email=o),type:"email",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.email]]),(K=l.value)!=null&&K.email?(r(),n("span",Te,i(l.value.email[0]),1)):d("",!0)]),s("div",Me,[e[27]||(e[27]=s("label",{class:"form-label small fw-semibold mb-1"},"Golongan / Ruang",-1)),m(s("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>a(t).user.employee.gol_ruang=o),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.gol_ruang]]),(C=l.value)!=null&&C.gol_ruang?(r(),n("span",De,i(l.value.gol_ruang[0]),1)):d("",!0)]),s("div",Ne,[e[28]||(e[28]=s("label",{class:"form-label small fw-semibold mb-1"},"Jabatan",-1)),m(s("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>a(t).user.employee.job_title=o),type:"text",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.job_title]]),(T=l.value)!=null&&T.job_title?(r(),n("span",Ee,i(l.value.job_title[0]),1)):d("",!0)]),s("div",Ie,[e[30]||(e[30]=s("label",{class:"form-label small fw-semibold mb-1"},"Unit Kerja",-1)),m(s("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>a(t).user.employee.id_work_unit=o),class:"form-control form-control-sm",disabled:""},[e[29]||(e[29]=s("option",{value:""},"Pilih Unit Kerja",-1)),(r(!0),n(F,null,Y(a(P).workunitList,o=>(r(),n("option",{key:o.id,value:o.id},i(o.text),9,Le))),128))],512),[[y,a(t).user.employee.id_work_unit]]),(M=l.value)!=null&&M.id_work_unit?(r(),n("span",Be,i(l.value.id_work_unit[0]),1)):d("",!0)]),s("div",Fe,[e[32]||(e[32]=s("label",{class:"form-label small fw-semibold mb-1"},"Status Kepegawaian",-1)),m(s("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>a(t).user.employee.employment_status=o),class:"form-control form-control-sm",disabled:""},e[31]||(e[31]=[s("option",{value:""},"Pilih",-1),s("option",{value:"PNS"},"PNS",-1),s("option",{value:"PPPK"},"PPPK",-1)]),512),[[y,a(t).user.employee.employment_status]]),(D=l.value)!=null&&D.employment_status?(r(),n("span",Ae,i(l.value.employment_status[0]),1)):d("",!0)]),s("div",Je,[e[33]||(e[33]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Pangkat",-1)),m(s("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>a(t).user.employee.tmt_pangkat=o),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.tmt_pangkat]]),(N=l.value)!=null&&N.tmt_pangkat?(r(),n("span",Re,i(l.value.tmt_pangkat[0]),1)):d("",!0)]),s("div",We,[e[34]||(e[34]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Jabatan",-1)),m(s("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>a(t).user.employee.tmt_jabatan=o),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.tmt_jabatan]]),(E=l.value)!=null&&E.tmt_jabatan?(r(),n("span",He,i(l.value.tmt_jabatan[0]),1)):d("",!0)]),s("div",ze,[e[35]||(e[35]=s("label",{class:"form-label small fw-semibold mb-1"},"TMT Pensiun",-1)),m(s("input",{"onUpdate:modelValue":e[12]||(e[12]=o=>a(t).user.employee.tmt_pensiun=o),type:"date",class:"form-control form-control-sm",readonly:""},null,512),[[p,a(t).user.employee.tmt_pensiun]]),(I=l.value)!=null&&I.tmt_pensiun?(r(),n("span",Ge,i(l.value.tmt_pensiun[0]),1)):d("",!0)]),s("div",$e,[e[37]||(e[37]=s("label",{class:"form-label small fw-semibold mb-1"},"Kategori",-1)),m(s("select",{"onUpdate:modelValue":e[13]||(e[13]=o=>a(t).user.employee.employment_category=o),class:"form-control form-control-sm",disabled:""},e[36]||(e[36]=[B('<option value="">Pilih</option><option value="ACTIVE">Aktif</option><option value="RETIRED">Pensiun</option><option value="LEFT">Berhenti</option><option value="DIED">Meninggal Dunia</option>',5)]),512),[[y,a(t).user.employee.employment_category]]),(L=l.value)!=null&&L.employment_category?(r(),n("span",qe,i(l.value.gender[0]),1)):d("",!0)]),e[40]||(e[40]=s("hr",null,null,-1)),s("div",Oe,[e[39]||(e[39]=s("hr",null,null,-1)),a(g).setting.maintenance?(r(),n("button",Ze," Maintenance ")):(r(),n("button",{key:0,type:"submit",class:"btn btn-success btn-sm",disabled:v.value},[v.value?(r(),n("i",Xe)):(r(),n("i",Ye)),e[38]||(e[38]=k(" Simpan Perubahan "))],8,Qe))])],32)]),s("div",es,[s("form",{onSubmit:x(G,["prevent"]),class:"form-horizontal"},[s("div",ss,[e[41]||(e[41]=s("label",{for:"currentPassword",class:"col-sm-3 col-form-label"},"Kata Sandi Saat Ini",-1)),s("div",ts,[m(s("input",{"onUpdate:modelValue":e[15]||(e[15]=o=>c.currentPassword=o),type:"password",class:"form-control",id:"currentPassword",placeholder:"Kata Sandi Saat Ini"},null,512),[[p,c.currentPassword]]),l.value&&l.value.current_password?(r(),n("span",os,i(l.value.current_password[0]),1)):d("",!0)])]),s("div",ls,[e[42]||(e[42]=s("label",{for:"newPassword",class:"col-sm-3 col-form-label"},"Kata Sandi Baru",-1)),s("div",as,[m(s("input",{"onUpdate:modelValue":e[16]||(e[16]=o=>c.password=o),type:"password",class:"form-control",id:"newPassword",placeholder:"Kata Sandi Baru"},null,512),[[p,c.password]]),l.value&&l.value.password?(r(),n("span",ns,i(l.value.password[0]),1)):d("",!0)])]),s("div",rs,[e[43]||(e[43]=s("label",{for:"passwordConfirmation",class:"col-sm-3 col-form-label"},"Konfirmasi Kata Sandi Baru",-1)),s("div",is,[m(s("input",{"onUpdate:modelValue":e[17]||(e[17]=o=>c.passwordConfirmation=o),type:"password",class:"form-control",id:"passwordConfirmation",placeholder:"Konfirmasi Kata Sandi Baru"},null,512),[[p,c.passwordConfirmation]])])]),s("div",ds,[s("div",ms,[s("button",{type:"submit",class:"btn btn-success",disabled:_.value},[_.value?(r(),n("i",ps)):(r(),n("i",cs)),e[44]||(e[44]=k(" Save Changes "))],8,us)])])],32)])])]),s("button",{onClick:x(H,["prevent"]),type:"button",class:"btn btn-danger btn-block"},e[45]||(e[45]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),k(" Logout")]))])])])])])],64)}}};export{gs as default};
