import{_ as E,e as f,s as I,x as O,r as S,f as z,c as r,o as d,g as p,a as e,w as b,T as x,h as T,i as k,v as w,k as B,y as Q,m as X,p as A,t as G,d as K,q as L}from"./app-DVuBMGX5.js";import{R as j}from"./laravel-turnstile-vue.es-MRwSE2J1.js";const H={class:"login-page"},J={key:0,class:"loading-overlay"},W={class:"login-box"},Y={class:"card card-outline card-success"},Z={class:"card-body login-card-body"},$={key:0,class:"login-box-msg"},ee={key:1,class:"login-box-msg"},se={key:0,class:"alert alert-danger",role:"alert"},ae={key:0,class:"alert alert-success",role:"alert"},te={class:"input-group mb-3"},oe={class:"text-center row justify-content-center"},le={class:"form-group recaptcha-container mx-auto"},ne={class:"row mb-3"},ie={class:"col-12"},re=["disabled"],de={class:"text-center"},ue={class:"input-group mb-3"},pe={class:"input-group mb-3"},me={class:"input-group mb-3"},ce={class:"text-center row justify-content-center"},ve={class:"form-group recaptcha-container mx-auto"},fe={class:"row mb-3"},ge={class:"col-12"},_e=["disabled"],be={class:"text-center"},F="0x4AAAAAABg5q-5b8cUPKPGt",ke={__name:"ResetPassword",setup(we){const V=I(),N=X(),q=f(V.query.token||""),y=f(V.query.email||""),P=O(()=>q.value?"reset":"request"),n=f(""),u=f(!1),m=f(""),c=f(""),h=S({email:""}),t=S({email:y.value||"",password:"",password_confirmation:""});z(()=>{y.value&&!t.email&&(t.email=y.value)});const C=async()=>{var v,s,i,a,g,_;u.value=!0,m.value="",c.value="";try{await L.post("/forgot-password",{email:h.email,"cf-turnstile-response":n.value}),m.value="Link reset password sudah dikirim ke email Anda (cek juga folder Spam)."}catch(o){c.value=((s=(v=o==null?void 0:o.response)==null?void 0:v.data)==null?void 0:s.message)||((_=(g=(a=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:a.errors)==null?void 0:g.email)==null?void 0:_[0])||"Gagal mengirim link reset. Pastikan email benar."}finally{u.value=!1}},D=async()=>{var v,s,i,a,g,_,o,R,M,U;u.value=!0,m.value="",c.value="";try{await L.post("/reset-password",{token:q.value,email:t.email,password:t.password,password_confirmation:t.password_confirmation,"cf-turnstile-response":n.value}),m.value="Password berhasil direset. Anda akan diarahkan ke halaman login...",setTimeout(()=>{N.push({path:"/"})},1500)}catch(l){c.value=((s=(v=l==null?void 0:l.response)==null?void 0:v.data)==null?void 0:s.message)||((_=(g=(a=(i=l==null?void 0:l.response)==null?void 0:i.data)==null?void 0:a.errors)==null?void 0:g.email)==null?void 0:_[0])||((U=(M=(R=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:R.errors)==null?void 0:M.password)==null?void 0:U[0])||"Gagal reset password. Periksa kembali data Anda."}finally{u.value=!1}};return(v,s)=>{const i=Q("router-link");return d(),r("div",H,[p(x,{name:"fade"},{default:b(()=>[u.value?(d(),r("div",J,s[6]||(s[6]=[e("div",{class:"spinner"},null,-1),e("p",null,"Memproses...",-1)]))):A("",!0)]),_:1}),e("div",W,[s[13]||(s[13]=e("div",{class:"login-logo"},[e("img",{src:"http://res.cloudinary.com/dezj1x6xp/image/upload/v1749880420/PandanViewMandeh/LOGO_SIGARDA_FIX_rw2u1g.png",alt:"logo",width:"100%"})],-1)),e("div",Y,[e("div",Z,[P.value==="request"?(d(),r("p",$," Masukkan email Anda untuk menerima link reset password ")):(d(),r("p",ee," Atur password baru Anda ")),p(x,{name:"fade"},{default:b(()=>[c.value?(d(),r("div",se,G(c.value),1)):A("",!0)]),_:1}),p(x,{name:"fade"},{default:b(()=>[m.value?(d(),r("div",ae,G(m.value),1)):A("",!0)]),_:1}),P.value==="request"?(d(),r("form",{key:2,onSubmit:T(C,["prevent"]),autocomplete:"off"},[e("div",te,[k(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>h.email=a),type:"email",class:"form-control",placeholder:"Email Anda",required:""},null,512),[[w,h.email]]),s[7]||(s[7]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-envelope"})])],-1))]),e("div",oe,[e("div",le,[p(B(j),{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=a=>n.value=a),sitekey:F,theme:"light"},null,8,["modelValue"])])]),e("div",ne,[e("div",ie,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:u.value||!n.value}," Kirim Link Reset ",8,re)])]),e("div",de,[p(i,{to:{path:"/login"}},{default:b(()=>s[8]||(s[8]=[K("Kembali ke Login")])),_:1})])],32)):(d(),r("form",{key:3,onSubmit:T(D,["prevent"]),autocomplete:"off"},[e("div",ue,[k(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.email=a),type:"email",class:"form-control",placeholder:"Email",required:""},null,512),[[w,t.email]]),s[9]||(s[9]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-envelope"})])],-1))]),e("div",pe,[k(e("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>t.password=a),type:"password",class:"form-control",placeholder:"Password baru",minlength:"8",required:""},null,512),[[w,t.password]]),s[10]||(s[10]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-lock"})])],-1))]),e("div",me,[k(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>t.password_confirmation=a),type:"password",class:"form-control",placeholder:"Ulangi password baru",minlength:"8",required:""},null,512),[[w,t.password_confirmation]]),s[11]||(s[11]=e("div",{class:"input-group-append"},[e("div",{class:"input-group-text"},[e("span",{class:"fas fa-lock"})])],-1))]),e("div",ce,[e("div",ve,[p(B(j),{modelValue:n.value,"onUpdate:modelValue":s[5]||(s[5]=a=>n.value=a),sitekey:F,theme:"light"},null,8,["modelValue"])])]),e("div",fe,[e("div",ge,[e("button",{type:"submit",class:"btn btn-primary btn-block",disabled:u.value||!n.value}," Simpan Password Baru ",8,_e)])]),e("div",be,[p(i,{to:{path:"/"}},{default:b(()=>s[12]||(s[12]=[K("Kembali ke Login")])),_:1})])],32))])])])])}}},xe=E(ke,[["__scopeId","data-v-bf451f83"]]);export{xe as default};
