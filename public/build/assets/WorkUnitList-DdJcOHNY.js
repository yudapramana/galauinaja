import{_ as y,e as u,f as T,c,o as m,b as S,a as e,t as f,h as W,i as v,v as g,E as j,F as h,G as V,q as r,$ as l,I as $}from"./app-r8EeV8UG.js";import"./style-DqCRSz3P.js";const B={class:"content"},C={class:"container-fluid"},D={class:"d-flex gap-2"},E=["disabled"],q={class:"modal fade",id:"editModal",tabindex:"-1"},H={class:"modal-dialog"},L={class:"modal-content"},N={class:"modal-header"},A={class:"modal-title"},F={class:"modal-body"},I={class:"form-group"},G={class:"form-group"},J={class:"form-group"},K=["value"],P={__name:"WorkUnitList",setup(R){const a=u({id:null,unit_name:"",unit_code:"",parent_unit:null}),d=u(!1),p=u([]),s=()=>{r.get("/api/work-units/tree").then(i=>{p.value=b(i.data);const t=_(i.data);k(t)})},b=(i,t=[])=>{var n;for(const o of i)t.push({id:o.id,unit_name:o.unit_name}),(n=o.children)!=null&&n.length&&b(o.children,t);return t},_=i=>i.flatMap(t=>{const n={id:t.id,parent:t.parent_unit??"#",text:t.unit_name,original:t,state:{opened:!0}},o=t.children?_(t.children):[];return[n,...o]}),k=i=>{$(()=>{const t=l("#tree-container");t.jstree(!0)&&t.jstree(!0).destroy(),t.jstree({core:{data:i,themes:{stripes:!0}}}),t.on("select_node.jstree",(n,o)=>{a.value={id:o.node.id,unit_name:o.node.original.original.unit_name,unit_code:o.node.original.original.unit_code,parent_unit:o.node.original.original.parent_unit},d.value=!0,l("#editModal").modal("show")})})},U=()=>{r.put(`/api/work-units/${a.value.id}`,a.value).then(()=>{l("#editModal").modal("hide"),s()})},M=()=>{r.post("/api/work-units",a.value).then(()=>{l("#editModal").modal("hide"),s()})},w=()=>{!a.value.id||!confirm("Hapus unit ini?")||r.delete(`/api/work-units/${a.value.id}`).then(()=>{a.value={id:null,unit_name:"",unit_code:"",parent_unit:null},s()})},x=()=>{a.value={id:null,unit_name:"",unit_code:"",parent_unit:null},d.value=!1,l("#editModal").modal("show")};return T(s),(i,t)=>(m(),c(h,null,[t[12]||(t[12]=S('<div class="content-header" data-v-6d3e3c92><div class="container-fluid" data-v-6d3e3c92><div class="row mb-2" data-v-6d3e3c92><div class="col-sm-6" data-v-6d3e3c92><h1 class="m-0" data-v-6d3e3c92>Satuan Kerja</h1></div><div class="col-sm-6" data-v-6d3e3c92><ol class="breadcrumb float-sm-right" data-v-6d3e3c92><li class="breadcrumb-item" data-v-6d3e3c92><a href="#" data-v-6d3e3c92>Home</a></li><li class="breadcrumb-item active" data-v-6d3e3c92>Daftar Satker</li></ol></div></div></div></div>',1)),e("div",B,[e("div",C,[e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[t[4]||(t[4]=e("h5",null,"Work Unit Tree",-1)),e("button",{class:"btn btn-sm btn-primary",onClick:s},"Refresh")]),t[11]||(t[11]=e("div",{id:"tree-container",class:"mb-3"},null,-1)),e("div",D,[e("button",{class:"btn btn-sm btn-success",onClick:x},"Tambah Unit"),e("button",{class:"btn btn-sm btn-danger",onClick:w,disabled:!a.value.id},"Hapus Unit",8,E)]),e("div",q,[e("div",H,[e("div",L,[e("div",N,[e("h5",A,f(d.value?"Edit":"Tambah")+" Work Unit",1),t[5]||(t[5]=e("button",{type:"button",class:"close","data-dismiss":"modal"},"Ã—",-1))]),e("form",{onSubmit:t[3]||(t[3]=W(n=>d.value?U():M(),["prevent"]))},[e("div",F,[e("div",I,[t[6]||(t[6]=e("label",null,"Unit Name",-1)),v(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>a.value.unit_name=n),class:"form-control form-control-sm",required:""},null,512),[[g,a.value.unit_name]])]),e("div",G,[t[7]||(t[7]=e("label",null,"Unit Code",-1)),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>a.value.unit_code=n),class:"form-control form-control-sm",required:""},null,512),[[g,a.value.unit_code]])]),e("div",J,[t[9]||(t[9]=e("label",null,"Parent Unit",-1)),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>a.value.parent_unit=n),class:"form-control form-control-sm"},[t[8]||(t[8]=e("option",{value:null},"-- Tidak Ada --",-1)),(m(!0),c(h,null,V(p.value,n=>(m(),c("option",{key:n.id,value:n.id},f(n.unit_name),9,K))),128))],512),[[j,a.value.parent_unit]])])]),t[10]||(t[10]=e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary btn-sm","data-dismiss":"modal"},"Batal"),e("button",{type:"submit",class:"btn btn-primary btn-sm"},"Simpan")],-1))],32)])])])])])],64))}},Q=y(P,[["__scopeId","data-v-6d3e3c92"]]);export{Q as default};
