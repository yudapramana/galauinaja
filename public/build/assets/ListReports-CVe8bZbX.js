import{n as U,q as K,u as R,c as B,J as A,K as c,x as E,y as F,d as e,f as t,z as l,j as _,e as M,w as L,h as O,D as q,L as I,F as r,B as g,M as J,m as w,o as s,t as i,l as u,g as k}from"./app-CZjyxVNa.js";import{f as D,a as z}from"./helper-CsXp_ZZG.js";import{a as W}from"./laravel-vue-pagination.es-DmF9HU-8.js";import{S as C}from"./sweetalert2.all-6Ntn0CAY.js";const G={class:"content-header"},Q={class:"container-fluid"},X={class:"row mb-2"},Z=t("div",{class:"col-sm-6"},[t("h1",{class:"m-0"},"Laporan Kerja")],-1),tt={key:0,class:"col-sm-6"},et=t("ol",{class:"breadcrumb float-sm-right"},[t("li",{class:"breadcrumb-item"},[t("a",{href:"#"},"Home")]),t("li",{class:"breadcrumb-item active"},"Laporan Kerja")],-1),st=[et],at={class:"content"},ot={class:"container-fluid"},nt={class:"row"},it={class:"col-lg-12"},lt={class:"d-flex justify-content-between mb-2"},dt={key:0},ct=t("button",{class:"btn btn-primary"},[t("i",{class:"fa fa-plus-circle mr-1"}),u(" Tambah ")],-1),rt={class:"btn-group"},_t=t("span",{class:"mr-1"},"Print",-1),ht=[_t],ut=["value"],mt=t("hr",null,null,-1),ft={key:0,class:"text-center"},pt=t("div",{class:"overlay"},[t("i",{class:"fas fa-3x fa-sync-alt fa-spin"}),t("div",{class:"text-bold pt-2"},"Loading...")],-1),vt=[pt],gt={key:0,class:"time-label"},bt={class:"bg-primary badge badge-primary badge-sm"},yt={style:{"margin-bottom":"10px"}},xt={class:"timeline-item"},Yt={class:"time"},Mt=["onClick"],kt={class:"timeline-header",style:{"font-size":"smaller","line-height":"1 !important"}},Ct={class:"time"},St={class:"timeline-body",style:{"font-size":"small","line-height":"1 !important"}},Bt=t("br",null,null,-1),Lt={style:{"font-size":"smaller"}},wt=t("br",null,null,-1),Dt={style:{"text-align":"right"}},$t={style:{"font-size":"smaller",width:"100%"}},Tt=["href"],zt={class:"bg-primary badge badge-primary badge-sm"},jt=["onClick"],Ht={key:2,class:"text-center"},Nt={key:1,class:"card"},Pt={class:"card-body"},Vt={class:"table-responsive overlay-wrapper"},Ut={key:0,class:"overlay"},Kt=t("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1),Rt=t("div",{class:"text-bold pt-2"},"Loading...",-1),At=[Kt,Rt],Et={class:"table table-bordered",style:{"line-height":"1 !important"}},Ft=t("thead",null,[t("tr",null,[t("th",{scope:"col text-sm"},"Tanggal"),t("th",{scope:"col text-sm",class:"text-center"},"#"),t("th",{scope:"col text-sm",width:"50%"},"Pekerjaan"),t("th",{scope:"col text-sm",class:"text-right"},"Vol"),t("th",{scope:"col text-sm"},"Unit"),t("th",{scope:"col text-sm"},"Eviden"),t("th",{scope:"col text-sm"},"Options")])],-1),Ot={key:0},qt=["rowspan"],It={class:"text-center text-sm"},Jt={class:"s text-sm"},Wt=t("br",null,null,-1),Gt=["innerHTML"],Qt={class:"s text-right text-sm"},Xt={class:"s text-sm"},Zt={class:"s text-sm"},te=["href"],ee={class:"text-center"},se=t("i",{class:"fa fa-edit"},null,-1),ae=["onClick"],oe=t("i",{class:"fa fa-trash text-danger ml-2"},null,-1),ne=[oe],ie={class:"s text-sm",style:{"white-space":"pre"}},le={class:"s text-center text-sm"},de=["onClick"],ce=t("i",{class:"fa fa-trash text-danger"},null,-1),re=[ce],_e=t("td",{colspan:"7",class:"text-center text-sm"},"Belum ada data...",-1),he={key:1},ue=t("tr",null,[t("td",{colspan:"7",class:"text-center"},"Tidak ada hasil, silahkan pilih bulan... ")],-1),me=[ue],ye={__name:"ListReports",setup(fe){const b=U(),y=K(),j=R(),d=B({data:[]}),S=(f=1)=>{y.toggleLoading(),w.get(`/api/reports?monthyear=${m.value}&page=${f}`).then(n=>{d.value=n.data,y.toggleLoading()}).catch(n=>{n.response&&n.response.status===401?window.location.href="/login":console.error("Terjadi kesalahan:",n)})},$=(f,n)=>{C.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(h=>{h.isConfirmed&&w.delete(`/api/reports/${n}`).then(x=>{d.value.data[f].works=d.value.data[f].works.filter(p=>p.id!==n),C.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})})})},T=(f,n)=>{C.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(h=>{h.isConfirmed&&w.delete(`/api/parent-reports/${n}`).then(x=>{d.value.data=d.value.data.filter(p=>p.id!==n),C.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"})})})},m=A("SettingStore:mySelected",B("")),H=B([{text:c().subtract(5,"months").format("MMMM  YYYY"),id:c().subtract(5,"months").format("YYYY-MM")},{text:c().subtract(4,"months").format("MMMM  YYYY"),id:c().subtract(4,"months").format("YYYY-MM")},{text:c().subtract(3,"months").format("MMMM  YYYY"),id:c().subtract(3,"months").format("YYYY-MM")},{text:c().subtract(2,"months").format("MMMM  YYYY"),id:c().subtract(2,"months").format("YYYY-MM")},{text:c().subtract(1,"months").format("MMMM  YYYY"),id:c().subtract(1,"months").format("YYYY-MM")},{text:c().format("MMMM  YYYY"),id:c().format("YYYY-MM")}]),N=()=>{S()},P=()=>{j.user.nama_pemeriksa?m.value?window.open("/print-lckb/"+m.value,"_blank"):alert("Pilih bulan dan tahun terlebih dahulu!"):alert("Nama dan NIP pemeriksa belum diisi!. Harap diisi di profil!")};return E(()=>{S()}),(f,n)=>{var x,p;const h=F("router-link");return s(),e(r,null,[t("div",G,[t("div",Q,[t("div",X,[Z,l(b).isMobile?_("",!0):(s(),e("div",tt,st))])])]),t("div",at,[t("div",ot,[t("div",nt,[t("div",it,[t("div",lt,[l(b).isMobile?_("",!0):(s(),e("div",dt,[M(h,{to:"/admin/reports/create"},{default:L(()=>[ct]),_:1})])),t("div",rt,[t("button",{onClick:n[0]||(n[0]=o=>P()),class:"btn btn-secondary"},ht),O(t("select",{"onUpdate:modelValue":n[1]||(n[1]=o=>I(m)?m.value=o:null),class:"custom-select rounded-0",onChange:n[2]||(n[2]=o=>N())},[(s(!0),e(r,null,g(H.value,o=>(s(),e("option",{value:o.id,key:o.id},i(o.text),9,ut))),128))],544),[[q,l(m)]])])]),l(b).isMobile?(s(),e("div",{key:0,class:"timeline",style:J(d.value.last_page==1?"margin-bottom: 100px":"")},[mt,l(y).isLoading?(s(),e("div",ft,vt)):_("",!0),d.value.data.length>0?(s(!0),e(r,{key:1},g(d.value.data,(o,v)=>(s(),e(r,null,[o.works.length>0?(s(!0),e(r,{key:0},g(o.works,(a,Y)=>(s(),e(r,{key:a.id},[Y===0?(s(),e("div",gt,[t("span",bt,i(l(D)(o.date)),1)])):_("",!0),t("div",yt,[t("div",xt,[t("span",Yt,[M(h,{to:`/admin/reports/${a.id}/edit`,class:"badge badge-info right",style:{"margin-right":"3px"}},{default:L(()=>[u(" Ubah ")]),_:2},1032,["to"]),t("a",{href:"#",class:"badge badge-danger right",onClick:k(V=>$(v,a.id),["prevent"])}," Hapus ",8,Mt)]),t("h3",kt,[t("span",Ct,i(l(D)(o.date)),1)]),t("div",St,[u(" ["+i(a.volume)+" "+i(a.unit)+"] "+i(a.work_name),1),Bt,t("span",Lt,i(a.work_detail),1),wt,t("div",Dt,[t("span",$t,[u(" Bukti Dukung "),a.evidence_url?(s(),e("a",{key:0,target:"blank",href:a.evidence_url??"#"}," [ "+i(a.evidence)+" ]",9,Tt)):(s(),e(r,{key:1},[u(" [ "+i(a.evidence)+" ] ",1)],64))])])])])])],64))),128)):(s(),e(r,{key:1},[(s(),e("div",{class:"time-label",key:o.id},[t("span",zt,i(l(D)(o.date)),1),t("a",{class:"badge badge-danger",style:{"margin-left":"3px"},href:"#",onClick:k(a=>T(v,o.id),["prevent"])}," hapus ",8,jt)])),(s(),e("div",{key:o.id}," .: Belum ada Data :. "))],64))],64))),256)):(s(),e("div",Ht," .: Belum ada Data :. "))],4)):_("",!0),l(b).isMobile?_("",!0):(s(),e("div",Nt,[t("div",Pt,[t("div",Vt,[l(y).isLoading?(s(),e("div",Ut,At)):_("",!0),t("table",Et,[Ft,((x=d.value.data)==null?void 0:x.length)>0?(s(),e("tbody",Ot,[(s(!0),e(r,null,g(d.value.data,(o,v)=>(s(),e(r,null,[o.works.length>0?(s(!0),e(r,{key:0},g(o.works,(a,Y)=>(s(),e("tr",{key:a.id},[Y===0?(s(),e("td",{key:0,rowspan:o.works.length,class:"s text-sm",style:{"white-space":"pre"}},i(l(z)(o.date)),9,qt)):_("",!0),t("td",It,i(Y+1),1),t("td",Jt,[u(i(a.work_name)+" ",1),Wt,t("p",{class:"text-muted m-0 p-0",style:{"font-size":"smaller !important"},innerHTML:a.work_detail},null,8,Gt)]),t("td",Qt,i(a.volume),1),t("td",Xt,i(a.unit),1),t("td",Zt,[a.evidence_url?(s(),e("a",{key:0,target:"blank",href:a.evidence_url??"#"},i(a.evidence),9,te)):(s(),e(r,{key:1},[u(i(a.evidence),1)],64))]),t("td",ee,[M(h,{to:`/admin/reports/${a.id}/edit`},{default:L(()=>[se]),_:2},1032,["to"]),t("a",{href:"#",onClick:k(V=>$(v,a.id),["prevent"])},ne,8,ae)])]))),128)):(s(),e("tr",{key:o.id},[t("td",ie,i(l(z)(o.date)),1),t("td",le,[t("a",{href:"#",onClick:k(a=>T(v,o.id),["prevent"])},re,8,de)]),_e]))],64))),256))])):_("",!0),((p=d.value.data)==null?void 0:p.length)===0?(s(),e("tbody",he,me)):_("",!0)])])])])),M(l(W),{data:d.value,onPaginationChangePage:S,limit:1,keepLength:!0,style:{"margin-bottom":"100px"}},null,8,["data"])])])])])],64)}}};export{ye as default};
